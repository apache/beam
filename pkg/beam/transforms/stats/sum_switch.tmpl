package stats

import (
    "fmt"
    "reflect"

    "github.com/apache/beam/sdks/go/pkg/beam"
)

func sumSwitch(p *beam.Pipeline, t reflect.Type, col beam.PCollection) beam.PCollection {
    switch t.String() {
{{- range .X}}
    case "{{.Type}}":
		return beam.Combine(p, sum{{.Name}}Fn, col)
{{- end}}
	default:
		panic(fmt.Sprintf("Unexpected number type: %v", t))
	}
}
{{range .X}}
func sum{{.Name}}Fn(x, y {{.Type}}) {{.Type}} {
	return x + y
}
{{end}}
