SELECT
                    c.table_name
                  , c.column_name
                  , c.spanner_type
                  , (1 + COALESCE(t.indices, 0)) AS cells_mutated
                  FROM (
                    SELECT c.table_name, c.column_name, c.spanner_type, c.ordinal_position
                      FROM information_schema.columns as c
                      WHERE c.table_schema NOT IN
                      ('information_schema', 'spanner_sys', 'pg_catalog')) AS c
                  LEFT OUTER JOIN (
                    SELECT t.table_name, t.column_name, COUNT(*) AS indices
                      FROM information_schema.index_columns AS t 
                      WHERE t.index_name != 'PRIMARY_KEY'
                      AND t.table_schema NOT IN
                      ('information_schema', 'spanner_sys', 'pg_catalog')
                      GROUP BY t.table_name, t.column_name) AS t
                  USING (table_name, column_name)
                  ORDER BY c.table_name, c.ordinal_position