pipeline:
  type: chain
  transforms:
    - type: ReadFromKafka
      name: ReadFromMyTopic
      config:
#        format: JSON
#        schema: |
#          {
#            "type": "object",
#            "properties": {
#              "value": {"type": "string"}
#            }
#          }
        format: STRING
        topic: test
        bootstrap_servers: kafka:9092 # 10.128.0.13:9092
        auto_offset_reset_config: earliest
        # max_read_time_seconds: 10
#        consumer_config:
#          sasl.jaas.config: "org.apache.kafka.common.security.plain.PlainLoginModule required username='admin' password='BRtJ2zZ0';"
#          security.protocol: "SASL_PLAINTEXT"
#          sasl.mechanism: "PLAIN"

#    - type: MapToFields
#      name: ParseKafkaRecords
#      config:
#        language: python
#        fields:
#          text:
#            callable: |
#              def func(row):
#                # return row.payload.decode('utf-8')
#                return row.value
              
#    - type: WindowInto
#      name: Windowing
#      windowing:
#        type: fixed
#        size: 3s

#    - type: Combine
#      name: GroupByKey
#      windowing:
#        type: fixed
#        size: 5s
#      config:
#        group_by: key
#        combine:
#          text: concat

#    - type: WriteToText
#      config:
#        path: gs://my-warehouse/tmp/

    - type: LogForTesting
