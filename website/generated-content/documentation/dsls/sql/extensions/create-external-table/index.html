<!DOCTYPE html>
<!--
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at
   http://www.apache.org/licenses/LICENSE-2.0
 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License. See accompanying LICENSE file.
-->

<html lang="en">
  <!--
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at
   http://www.apache.org/licenses/LICENSE-2.0
 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License. See accompanying LICENSE file.
-->

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Beam SQL extension: CREATE EXTERNAL TABLE Statement</title>
  <meta name="description" content="Apache Beam is an open source, unified model and set of language-specific SDKs for defining and executing data processing workflows, and also data ingestion and integration flows, supporting Enterprise Integration Patterns (EIPs) and Domain Specific Languages (DSLs). Dataflow pipelines simplify the mechanics of large-scale batch and streaming data processing and can run on a number of runtimes like Apache Flink, Apache Spark, and Google Cloud Dataflow (a cloud service). Beam also brings DSL in different languages, allowing users to easily implement their data integration processes.
">
  <link href="https://fonts.googleapis.com/css?family=Roboto:100,300,400" rel="stylesheet">
  <link rel="stylesheet" href="/css/site.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.0/jquery.min.js"></script>
  <script src="/js/bootstrap.min.js"></script>
  <script src="/js/language-switch.js"></script>
  <script src="/js/fix-menu.js"></script>
  <script src="/js/section-nav.js"></script>
  <script src="/js/page-nav.js"></script>
  <link rel="canonical" href="https://beam.apache.org/documentation/dsls/sql/extensions/create-external-table/" data-proofer-ignore>
  <link rel="shortcut icon" type="image/x-icon" href="/images/favicon.ico">
  <link rel="alternate" type="application/rss+xml" title="Apache Beam" href="https://beam.apache.org/feed.xml">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.4.1/css/all.css" integrity="sha384-5sAR7xN1Nv6T6+dT2mhtzEpVJvfS3NScPQTrOxhwjIuvcA67KV2R5Jz6kr4abQsz" crossorigin="anonymous">
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-73650088-1', 'auto');
    ga('send', 'pageview');
  </script>
</head>

  <body class="body" data-spy="scroll" data-target=".page-nav" data-offset="0">
    <!--
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at
   http://www.apache.org/licenses/LICENSE-2.0
 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License. See accompanying LICENSE file.
-->

<nav class="header navbar navbar-fixed-top">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" aria-expanded="false" aria-controls="navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <a href="/" class="navbar-brand" >
        <img alt="Brand" style="height: 25px" src="/images/beam_logo_navbar.png">
      </a>
    </div>

    <div class="navbar-mask closed"></div>

    <div id="navbar" class="navbar-container closed">
      <ul class="nav navbar-nav">
        <li>
          <a href="/get-started/beam-overview/">Get Started</a>
        </li>
        <li>
          <a href="/documentation/">Documentation</a>
        </li>
        <li>
          <a href="/documentation/sdks/java/">Languages</a>
        </li>
        <li>
          <a href="/documentation/runners/capability-matrix/">RUNNERS</a>
        </li>
        <li>
          <a href="/roadmap/">Roadmap</a>
        </li>
        <li>
          <a href="/contribute/">Contribute</a>
        </li>
        <li>
          <a href="/community/contact-us/">Community</a>
        </li>
        <li><a href="/blog">Blog</a></li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
          <div style="width: 300px;">
            <script>
              (function() {
                var cx = '012923275103528129024:4emlchv9wzi';
                var gcse = document.createElement('script');
                gcse.type = 'text/javascript';
                gcse.async = true;
                gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
                var s = document.getElementsByTagName('script')[0];
                s.parentNode.insertBefore(gcse, s);
              })();
            </script>
            <gcse:search></gcse:search>
          </div>
        </li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false"><img src="https://www.apache.org/foundation/press/kit/feather_small.png" alt="Apache Logo" style="height:20px;"><span class="caret"></span></a>
          <ul class="dropdown-menu dropdown-menu-right">
            <li><a href="http://www.apache.org/">ASF Homepage</a></li>
            <li><a href="http://www.apache.org/licenses/">License</a></li>
            <li><a href="http://www.apache.org/security/">Security</a></li>
            <li><a href="http://www.apache.org/foundation/thanks.html">Thanks</a></li>
            <li><a href="http://www.apache.org/foundation/sponsorship.html">Sponsorship</a></li>
            <li><a href="https://www.apache.org/foundation/policies/conduct">Code of Conduct</a></li>
          </ul>
        </li>
        <li>
          <!--
            data-proofer-ignore disables link checking from website test automation.
            GitHub links will not resolve until the markdown source is available on the master branch.
            New pages would fail validation during development / PR test automation.
          -->
          <a href="https://github.com/apache/beam/edit/master/website/src/documentation/dsls/sql/extensions/create-external-table.md" data-proofer-ignore>
            <i class="far fa-edit fa-lg" alt="Edit on GitHub" title="Edit on GitHub"></i>
          </a>
        </li>
      </ul>
    </div>
</nav>

    <div class="clearfix container-main-content">
      <div class="section-nav closed" data-offset-top="90" data-offset-bottom="500">
        <span class="section-nav-back glyphicon glyphicon-menu-left"></span>
        <nav>
          <ul class="section-nav-list" data-section-nav>
            <!--
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at
   http://www.apache.org/licenses/LICENSE-2.0
 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License. See accompanying LICENSE file.
-->

<li><span class="section-nav-list-main-title">Languages</span></li>

<li>
  <span class="section-nav-list-title">Java</span>
  <ul class="section-nav-list">
    <li><a href="/documentation/sdks/java/">Java SDK overview</a></li>
    <li><a href="https://beam.apache.org/releases/javadoc/2.13.0/" target="_blank">Java SDK API reference <img src="/images/external-link-icon.png"
                                                                                                                                   width="14" height="14"
                                                                                                                                   alt="External link."></a>
    </li>
    <li><a href="/documentation/sdks/java-dependencies/">Java SDK dependencies</a></li>
    <li><a href="/documentation/sdks/java-extensions/">Java SDK extensions</a></li>
    <li><a href="/documentation/sdks/java-thirdparty/">Java 3rd party extensions</a></li>
    <li><a href="/documentation/sdks/java/testing/nexmark/">Nexmark benchmark suite</a></li>
  </ul>
</li>

<li>
  <span class="section-nav-list-title">Python</span>
  <ul class="section-nav-list">
    <li><a href="/documentation/sdks/python/">Python SDK overview</a></li>
    <li><a href="https://beam.apache.org/releases/pydoc/2.13.0/" target="_blank">Python SDK API reference <img src="/images/external-link-icon.png"
                                                                                                                                   width="14" height="14"
                                                                                                                                   alt="External link."></a>
    </li>
    <li><a href="/documentation/sdks/python-dependencies/">Python SDK dependencies</a></li>
    <li><a href="/documentation/sdks/python-streaming/">Python streaming pipelines</a></li>
    <li><a href="/documentation/sdks/python-type-safety/">Ensuring Python type safety</a></li>
    <li><a href="/documentation/sdks/python-pipeline-dependencies/">Managing pipeline dependencies</a></li>
  </ul>
</li>

<li>
  <span class="section-nav-list-title">Go</span>
  <ul class="section-nav-list">
    <li><a href="/documentation/sdks/go/">Go SDK overview</a></li>
    <li><a href="https://godoc.org/github.com/apache/beam/sdks/go/pkg/beam" target="_blank">Go SDK API reference <img src="/images/external-link-icon.png"
                                                                                                                                   width="14" height="14"
                                                                                                                                   alt="External link."></a>
    </li>
  </ul>
</li>

<li>
  <span class="section-nav-list-title">SQL</span>
  <ul class="section-nav-list">
    <li><a href="/documentation/dsls/sql/overview/">Overview</a></li>
    <li><a href="/documentation/dsls/sql/walkthrough/">Walkthrough</a></li>
    <li><a href="/documentation/dsls/sql/shell/">Shell</a></li>
    <li class="section-nav-item--collapsible">
      <span class="section-nav-list-title">Apache Calcite dialect</span>

      <ul class="section-nav-list">
        <li><a href="/documentation/dsls/sql/calcite/overview/">Calcite support overview</a></li>  
        <li><a href="/documentation/dsls/sql/calcite/query-syntax/">Query syntax</a></li>
        <li><a href="/documentation/dsls/sql/calcite/lexical/">Lexical structure</a></li>        
        <li><a href="/documentation/dsls/sql/calcite/data-types/">Data types</a></li>
        <li><a href="/documentation/dsls/sql/calcite/scalar-functions/">Scalar functions</a></li>
        <li><a href="/documentation/dsls/sql/calcite/aggregate-functions/">Aggregate functions</a></li>
      </ul>
    </li>
    <li class="section-nav-item--collapsible">
      <span class="section-nav-list-title">Beam SQL extensions</span>

      <ul class="section-nav-list">
        <li><a href="/documentation/dsls/sql/extensions/create-external-table/">CREATE EXTERNAL TABLE</a></li>
        <li><a href="/documentation/dsls/sql/extensions/windowing-and-triggering/">Windowing & triggering</a></li>
        <li><a href="/documentation/dsls/sql/extensions/joins/">Joins</a></li>
        <li><a href="/documentation/dsls/sql/extensions/user-defined-functions/">User-defined functions</a></li>
        <li><a href="/documentation/dsls/sql/extensions/set/">SET pipeline options</a></li>
      </ul>
    </li>
  </ul>
</li>

          </ul>
        </nav>
      </div>

      <nav class="page-nav clearfix" data-offset-top="90" data-offset-bottom="500">
        <!--
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at
   http://www.apache.org/licenses/LICENSE-2.0
 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License. See accompanying LICENSE file.
-->



<ul class="nav">
  <li><a href="#syntax">Syntax</a></li>
  <li><a href="#bigquery">BigQuery</a>
    <ul>
      <li><a href="#syntax-1">Syntax</a></li>
      <li><a href="#read-mode">Read Mode</a></li>
      <li><a href="#write-mode">Write Mode</a></li>
      <li><a href="#schema">Schema</a></li>
      <li><a href="#example">Example</a></li>
    </ul>
  </li>
  <li><a href="#pubsub">Pub/Sub</a>
    <ul>
      <li><a href="#syntax-2">Syntax</a></li>
      <li><a href="#read-mode-1">Read Mode</a></li>
      <li><a href="#write-mode-1">Write Mode</a></li>
      <li><a href="#schema-1">Schema</a></li>
      <li><a href="#supported-payload">Supported Payload</a></li>
      <li><a href="#example-1">Example</a></li>
    </ul>
  </li>
  <li><a href="#kafka">Kafka</a>
    <ul>
      <li><a href="#syntax-3">Syntax</a></li>
      <li><a href="#read-mode-2">Read Mode</a></li>
      <li><a href="#write-mode-2">Write Mode</a></li>
      <li><a href="#supported-payload-1">Supported Payload</a></li>
      <li><a href="#schema-2">Schema</a></li>
    </ul>
  </li>
  <li><a href="#text">Text</a>
    <ul>
      <li><a href="#syntax-4">Syntax</a></li>
      <li><a href="#read-mode-3">Read Mode</a></li>
      <li><a href="#write-mode-3">Write Mode</a></li>
      <li><a href="#supported-payload-2">Supported Payload</a></li>
      <li><a href="#schema-3">Schema</a></li>
      <li><a href="#example-2">Example</a></li>
    </ul>
  </li>
</ul>


      </nav>

      <div class="body__contained body__section-nav">
        <!--
Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
-->

<h1 id="beam-sql-extensions-create-external-table">Beam SQL extensions: CREATE EXTERNAL TABLE</h1>

<p>Beam SQL’s <code class="highlighter-rouge">CREATE EXTERNAL TABLE</code> statement registers a virtual table that maps to an
<a href="/documentation/io/built-in/">external storage system</a>.
For some storage systems, <code class="highlighter-rouge">CREATE EXTERNAL TABLE</code> does not create a physical table until
a write occurs. After the physical table exists, you can access the table with
the <code class="highlighter-rouge">SELECT</code>, <code class="highlighter-rouge">JOIN</code>, and <code class="highlighter-rouge">INSERT INTO</code> statements.</p>

<p>The <code class="highlighter-rouge">CREATE EXTERNAL TABLE</code> statement includes a schema and extended clauses.</p>

<h2 id="syntax">Syntax</h2>

<div class="highlighter-rouge"><pre class="highlight"><code>CREATE EXTERNAL TABLE [ IF NOT EXISTS ] tableName (tableElement [, tableElement ]*)
TYPE type
[LOCATION location]
[TBLPROPERTIES tblProperties]

simpleType: TINYINT | SMALLINT | INTEGER | BIGINT | FLOAT | DOUBLE | DECIMAL | BOOLEAN | DATE | TIME | TIMESTAMP | CHAR | VARCHAR

fieldType: simpleType | MAP&lt;simpleType, fieldType&gt; | ARRAY&lt;fieldType&gt; | ROW&lt;tableElement [, tableElement ]*&gt;

tableElement: columnName fieldType [ NOT NULL ]
</code></pre>
</div>

<ul>
  <li><code class="highlighter-rouge">IF NOT EXISTS</code>: Optional. If the table is already registered, Beam SQL
ignores the statement instead of returning an error.</li>
  <li><code class="highlighter-rouge">tableName</code>: The case sensitive name of the table to create and register,
specified as an
<a href="/documentation/dsls/sql/calcite/lexical#identifiers">Identifier</a>.
The table name does not need to match the name in the underlying data
storage system.</li>
  <li><code class="highlighter-rouge">tableElement</code>: <code class="highlighter-rouge">columnName</code> <code class="highlighter-rouge">fieldType</code> <code class="highlighter-rouge">[ NOT NULL ]</code>
    <ul>
      <li><code class="highlighter-rouge">columnName</code>: The case sensitive name of the column, specified as a
backtick_quoted_expression.</li>
      <li><code class="highlighter-rouge">fieldType</code>: The field’s type, specified as one of the following types:
        <ul>
          <li><code class="highlighter-rouge">simpleType</code>: <code class="highlighter-rouge">TINYINT</code>, <code class="highlighter-rouge">SMALLINT</code>, <code class="highlighter-rouge">INTEGER</code>, <code class="highlighter-rouge">BIGINT</code>, <code class="highlighter-rouge">FLOAT</code>,
<code class="highlighter-rouge">DOUBLE</code>, <code class="highlighter-rouge">DECIMAL</code>, <code class="highlighter-rouge">BOOLEAN</code>, <code class="highlighter-rouge">DATE</code>, <code class="highlighter-rouge">TIME</code>, <code class="highlighter-rouge">TIMESTAMP</code>, <code class="highlighter-rouge">CHAR</code>,
<code class="highlighter-rouge">VARCHAR</code></li>
          <li><code class="highlighter-rouge">MAP&lt;simpleType, fieldType&gt;</code></li>
          <li><code class="highlighter-rouge">ARRAY&lt;fieldType&gt;</code></li>
          <li><code class="highlighter-rouge">ROW&lt;tableElement [, tableElement ]*&gt;</code></li>
        </ul>
      </li>
      <li><code class="highlighter-rouge">NOT NULL</code>: Optional. Indicates that the column is not nullable.</li>
    </ul>
  </li>
  <li><code class="highlighter-rouge">type</code>: The I/O transform that backs the virtual table, specified as an
<a href="/documentation/dsls/sql/calcite/lexical/#identifiers">Identifier</a>
with one of the following values:
    <ul>
      <li><code class="highlighter-rouge">bigquery</code></li>
      <li><code class="highlighter-rouge">pubsub</code></li>
      <li><code class="highlighter-rouge">kafka</code></li>
      <li><code class="highlighter-rouge">text</code></li>
    </ul>
  </li>
  <li><code class="highlighter-rouge">location</code>: The I/O specific location of the underlying table, specified as
a <a href="/documentation/dsls/sql/calcite/lexical/#string-literals">String
Literal</a>.
See the I/O specific sections for <code class="highlighter-rouge">location</code> format requirements.</li>
  <li><code class="highlighter-rouge">tblProperties</code>: The I/O specific quoted key value JSON object with extra
configuration, specified as a <a href="/documentation/dsls/sql/calcite/lexical/#string-literals">String
Literal</a>.
See the I/O specific sections for <code class="highlighter-rouge">tblProperties</code> format requirements.</li>
</ul>

<h2 id="bigquery">BigQuery</h2>

<h3 id="syntax-1">Syntax</h3>

<div class="highlighter-rouge"><pre class="highlight"><code>CREATE EXTERNAL TABLE [ IF NOT EXISTS ] tableName (tableElement [, tableElement ]*)
TYPE bigquery
LOCATION '[PROJECT_ID]:[DATASET].[TABLE]'
</code></pre>
</div>

<ul>
  <li><code class="highlighter-rouge">LOCATION:</code>Location of the table in the BigQuery CLI format.
    <ul>
      <li><code class="highlighter-rouge">PROJECT_ID</code>: ID of the Google Cloud Project</li>
      <li><code class="highlighter-rouge">DATASET</code>: BigQuery Dataset ID</li>
      <li><code class="highlighter-rouge">TABLE</code>: BigQuery Table ID within the Dataset</li>
    </ul>
  </li>
</ul>

<h3 id="read-mode">Read Mode</h3>

<p>Beam SQL supports reading columns with simple types (<code class="highlighter-rouge">simpleType</code>) and arrays of simple
types (<code class="highlighter-rouge">ARRAY&lt;simpleType&gt;</code>).</p>

<h3 id="write-mode">Write Mode</h3>

<p>if the table does not exist, Beam creates the table specified in location when
the first record is written. If the table does exist, the specified columns must
match the existing table.</p>

<h3 id="schema">Schema</h3>

<p>Schema-related errors will cause the pipeline to crash. The Map type is not
supported. Beam SQL types map to <a href="https://cloud.google.com/bigquery/docs/reference/standard-sql/data-types">BigQuery Standard SQL
types</a>
as follows:</p>

<table>
  <tr>
   <td>Beam SQL Type
   </td>
   <td>BigQuery Standard SQL Type
   </td>
  </tr>
  <tr>
   <td>TINYINT, SMALLINT, INTEGER, BIGINT &nbsp;
   </td>
   <td>INT64
   </td>
  </tr>
  <tr>
   <td>FLOAT, DOUBLE, DECIMAL
   </td>
   <td>FLOAT64
   </td>
  </tr>
  <tr>
   <td>BOOLEAN
   </td>
   <td>BOOL
   </td>
  </tr>
  <tr>
   <td>DATE
   </td>
   <td>DATE
   </td>
  </tr>
  <tr>
   <td>TIME
   </td>
   <td>TIME
   </td>
  </tr>
  <tr>
   <td>TIMESTAMP
   </td>
   <td>TIMESTAMP
   </td>
  </tr>
  <tr>
   <td>CHAR, VARCHAR
   </td>
   <td>STRING
   </td>
  </tr>
  <tr>
   <td>MAP
   </td>
   <td>(not supported)
   </td>
  </tr>
  <tr>
   <td>ARRAY
   </td>
   <td>ARRAY
   </td>
  </tr>
  <tr>
   <td>ROW
   </td>
   <td>STRUCT
   </td>
  </tr>
</table>

<h3 id="example">Example</h3>

<div class="highlighter-rouge"><pre class="highlight"><code>CREATE EXTERNAL TABLE users (id INTEGER, username VARCHAR)
TYPE bigquery
LOCATION 'testing-integration:apache.users'
</code></pre>
</div>

<h2 id="pubsub">Pub/Sub</h2>

<h3 id="syntax-2">Syntax</h3>

<div class="highlighter-rouge"><pre class="highlight"><code>CREATE EXTERNAL TABLE [ IF NOT EXISTS ] tableName
  (
   event_timestamp TIMESTAMP,
   attributes MAP&lt;VARCHAR, VARCHAR&gt;,
   payload ROW&lt;tableElement [, tableElement ]*&gt;
  )
TYPE pubsub
LOCATION 'projects/[PROJECT]/topics/[TOPIC]'
TBLPROPERTIES '{"timestampAttributeKey": "key", "deadLetterQueue": "projects/[PROJECT]/topics/[TOPIC]"}'
</code></pre>
</div>

<ul>
  <li><code class="highlighter-rouge">event_timestamp</code>: The event timestamp associated with the Pub/Sub message
by PubsubIO. It can be one of the following:
    <ul>
      <li>Message publish time, which is provided by Pub/Sub. This is the default
value if no extra configuration is provided.</li>
      <li>A timestamp specified in one of the user-provided message attributes.
The attribute key is configured by the <code class="highlighter-rouge">timestampAttributeKey</code> field of
the <code class="highlighter-rouge">tblProperties</code> blob. The value of the attribute should conform to
the <a href="https://beam.apache.org/releases/javadoc/2.4.0/org/apache/beam/sdk/io/gcp/pubsub/PubsubIO.Read.html#withTimestampAttribute-java.lang.String-">requirements of
PubsubIO</a>,
which is either millis since Unix epoch or <a href="https://www.ietf.org/rfc/rfc3339.txt">RFC 339
</a>date string.</li>
    </ul>
  </li>
  <li><code class="highlighter-rouge">attributes</code>: The user-provided attributes map from the Pub/Sub message;</li>
  <li><code class="highlighter-rouge">payload</code>: The schema of the JSON payload of the Pub/Sub message. No other
payload formats are currently supported by Beam SQL. If a record can’t be
unmarshalled, the record is written to the topic specified in the
<code class="highlighter-rouge">deadLeaderQueue</code> field of the <code class="highlighter-rouge">tblProperties</code> blob. If no dead-letter queue
is specified in this case, an exception is thrown and the pipeline will
crash.</li>
  <li><code class="highlighter-rouge">LOCATION</code>:
    <ul>
      <li><code class="highlighter-rouge">PROJECT</code>: ID of the Google Cloud Project</li>
      <li><code class="highlighter-rouge">TOPIC</code>: The Pub/Sub topic name. A subscription will be created
automatically, but the subscription is not cleaned up automatically.
Specifying an existing subscription is not supported.</li>
    </ul>
  </li>
  <li><code class="highlighter-rouge">TBLPROPERTIES</code>:
    <ul>
      <li><code class="highlighter-rouge">timestampAttributeKey</code>: Optional. The key which contains the event
timestamp associated with the Pub/Sub message. If not specified, the
message publish timestamp is used as an event timestamp for
windowing/watermarking.</li>
      <li><code class="highlighter-rouge">deadLetterQueue</code>: The topic into which messages are written if the
payload was not parsed. If not specified, an exception is thrown for
parsing failures.</li>
    </ul>
  </li>
</ul>

<h3 id="read-mode-1">Read Mode</h3>

<p>PubsubIO is currently limited to read access only.</p>

<h3 id="write-mode-1">Write Mode</h3>

<p>Not supported. PubSubIO is currently limited to read access only in Beam SQL.</p>

<h3 id="schema-1">Schema</h3>

<p>Pub/Sub messages have metadata associated with them, and you can reference this
metadata in your queries. For each message, Pub/Sub exposes its publish time and
a map of user-provided attributes in addition to the payload (unstructured in
the general case). This information must be preserved and accessible from the
SQL statements. Currently, this means that PubsubIO tables require you to
declare a special set of columns, as shown below.</p>

<h3 id="supported-payload">Supported Payload</h3>

<ul>
  <li>JSON Objects
    <ul>
      <li>Beam only supports querying messages with payload containing JSON
objects. Beam attempts to parse JSON to match the schema of the
<code class="highlighter-rouge">payload</code> field.</li>
    </ul>
  </li>
</ul>

<h3 id="example-1">Example</h3>

<div class="highlighter-rouge"><pre class="highlight"><code>CREATE EXTERNAL TABLE locations (event_timestamp TIMESTAMP, attributes MAP&lt;VARCHAR, VARCHAR&gt;, payload ROW&lt;id INTEGER, location VARCHAR&gt;)
TYPE pubsub
LOCATION 'projects/testing-integration/topics/user-location'
</code></pre>
</div>

<h2 id="kafka">Kafka</h2>

<p>KafkaIO is experimental in Beam SQL.</p>

<h3 id="syntax-3">Syntax</h3>

<div class="highlighter-rouge"><pre class="highlight"><code>CREATE EXTERNAL TABLE [ IF NOT EXISTS ] tableName (tableElement [, tableElement ]*)
TYPE kafka
LOCATION 'kafka://localhost:2181/brokers'
TBLPROPERTIES '{"bootstrap.servers":"localhost:9092", "topics": ["topic1", "topic2"]}'
</code></pre>
</div>

<ul>
  <li><code class="highlighter-rouge">LOCATION</code>: The Kafka topic URL.</li>
  <li><code class="highlighter-rouge">TBLPROPERTIES</code>:
    <ul>
      <li><code class="highlighter-rouge">bootstrap.servers</code>: Optional. Allows you to specify the bootstrap
server.</li>
      <li><code class="highlighter-rouge">topics</code>: Optional. Allows you to specify specific topics.</li>
    </ul>
  </li>
</ul>

<h3 id="read-mode-2">Read Mode</h3>

<p>Read Mode supports reading from a topic.</p>

<h3 id="write-mode-2">Write Mode</h3>

<p>Write Mode supports writing to a topic.</p>

<h3 id="supported-payload-1">Supported Payload</h3>

<ul>
  <li>CSV
    <ul>
      <li>Beam parses the messages, attempting to parse fields according to the
types specified in the schema.</li>
    </ul>
  </li>
</ul>

<h3 id="schema-2">Schema</h3>

<p>Only simple types are supported.</p>

<h2 id="text">Text</h2>

<p>TextIO is experimental in Beam SQL. Read Mode and Write Mode do not currently
access the same underlying data.</p>

<h3 id="syntax-4">Syntax</h3>

<div class="highlighter-rouge"><pre class="highlight"><code>CREATE EXTERNAL TABLE [ IF NOT EXISTS ] tableName (tableElement [, tableElement ]*)
TYPE text
LOCATION '/home/admin/orders'
TBLPROPERTIES '{"format: "Excel"}'
</code></pre>
</div>

<ul>
  <li><code class="highlighter-rouge">LOCATION</code>: The path to the file for Read Mode. The prefix for Write Mode.</li>
  <li><code class="highlighter-rouge">TBLPROPERTIES</code>:
    <ul>
      <li><code class="highlighter-rouge">format</code>: Optional. Allows you to specify the CSV Format, which controls
the field delimeter, quote character, record separator, and other properties.
See the following table:</li>
    </ul>
  </li>
</ul>

<table class="table-bordered">
  <thead>
    <tr>
      <th>Value for <code class="highlighter-rouge">format</code></th>
      <th>Field delimiter</th>
      <th>Quote</th>
      <th>Record separator</th>
      <th>Ignore empty lines?</th>
      <th>Allow missing column names?</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="highlighter-rouge">default</code></td>
      <td><code class="highlighter-rouge">,</code></td>
      <td><code class="highlighter-rouge">"</code></td>
      <td><code class="highlighter-rouge">\r\n</code></td>
      <td>Yes</td>
      <td>No</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">rfc4180</code></td>
      <td><code class="highlighter-rouge">,</code></td>
      <td><code class="highlighter-rouge">"</code></td>
      <td><code class="highlighter-rouge">\r\n</code></td>
      <td>No</td>
      <td>No</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">excel</code></td>
      <td><code class="highlighter-rouge">,</code></td>
      <td><code class="highlighter-rouge">"</code></td>
      <td><code class="highlighter-rouge">\r\n</code></td>
      <td>No</td>
      <td>Yes</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">tdf</code></td>
      <td><code class="highlighter-rouge">\t</code></td>
      <td><code class="highlighter-rouge">"</code></td>
      <td><code class="highlighter-rouge">\r\n</code></td>
      <td>Yes</td>
      <td>No</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">mysql</code></td>
      <td><code class="highlighter-rouge">\t</code></td>
      <td>none</td>
      <td><code class="highlighter-rouge">\n</code></td>
      <td>No</td>
      <td>No</td>
    </tr>
  </tbody>
</table>

<h3 id="read-mode-3">Read Mode</h3>

<p>Read Mode supports reading from a file.</p>

<h3 id="write-mode-3">Write Mode</h3>

<p>Write Mode supports writing to a set of files. TextIO creates file on writes.</p>

<h3 id="supported-payload-2">Supported Payload</h3>

<ul>
  <li>CSV
    <ul>
      <li>Beam parses the messages, attempting to parse fields according to the
types specified in the schema using org.apache.commons.csv.</li>
    </ul>
  </li>
</ul>

<h3 id="schema-3">Schema</h3>

<p>Only simple types are supported.</p>

<h3 id="example-2">Example</h3>

<div class="highlighter-rouge"><pre class="highlight"><code>CREATE EXTERNAL TABLE orders (id INTEGER, price INTEGER)
TYPE text
LOCATION '/home/admin/orders'
</code></pre>
</div>

      </div>
    </div>
    <!--
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at
   http://www.apache.org/licenses/LICENSE-2.0
 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License. See accompanying LICENSE file.
-->

<footer class="footer">
  <div class="footer__contained">
    <div class="footer__cols">
      <div class="footer__cols__col">
        <div class="footer__cols__col__logo">
          <img src="/images/beam_logo_circle.svg" class="footer__logo" alt="Beam logo">
        </div>
        <div class="footer__cols__col__logo">
          <img src="/images/apache_logo_circle.svg" class="footer__logo" alt="Apache logo">
        </div>
      </div>
      <div class="footer__cols__col footer__cols__col--md">
        <div class="footer__cols__col__title">Start</div>
        <div class="footer__cols__col__link"><a href="/get-started/beam-overview/">Overview</a></div>
        <div class="footer__cols__col__link"><a href="/get-started/quickstart-java/">Quickstart (Java)</a></div>
        <div class="footer__cols__col__link"><a href="/get-started/quickstart-py/">Quickstart (Python)</a></div>
        <div class="footer__cols__col__link"><a href="/get-started/quickstart-go/">Quickstart (Go)</a></div>
        <div class="footer__cols__col__link"><a href="/get-started/downloads/">Downloads</a></div>
      </div>
      <div class="footer__cols__col footer__cols__col--md">
        <div class="footer__cols__col__title">Docs</div>
        <div class="footer__cols__col__link"><a href="/documentation/programming-guide/">Concepts</a></div>
        <div class="footer__cols__col__link"><a href="/documentation/pipelines/design-your-pipeline/">Pipelines</a></div>
        <div class="footer__cols__col__link"><a href="/documentation/runners/capability-matrix/">Runners</a></div>
      </div>
      <div class="footer__cols__col footer__cols__col--md">
        <div class="footer__cols__col__title">Community</div>
        <div class="footer__cols__col__link"><a href="/contribute/">Contribute</a></div>
        <div class="footer__cols__col__link"><a href="https://projects.apache.org/committee.html?beam" target="_blank">Team<img src="/images/external-link-icon.png"
                                                                                                                                width="14" height="14"
                                                                                                                                alt="External link."></a></div>
        <div class="footer__cols__col__link"><a href="/contribute/presentation-materials/">Media</a></div>
      </div>
      <div class="footer__cols__col footer__cols__col--md">
        <div class="footer__cols__col__title">Resources</div>
        <div class="footer__cols__col__link"><a href="/blog/">Blog</a></div>
        <div class="footer__cols__col__link"><a href="/get-started/support/">Support</a></div>
        <div class="footer__cols__col__link"><a href="https://github.com/apache/beam">GitHub</a></div>
      </div>
    </div>
  </div>
  <div class="footer__bottom">
    &copy;
    <a href="http://www.apache.org">The Apache Software Foundation</a>
    | <a href="/privacy_policy">Privacy Policy</a>
    | <a href="/feed.xml">RSS Feed</a>
    <br><br>
    Apache Beam, Apache, Beam, the Beam logo, and the Apache feather logo are
    either registered trademarks or trademarks of The Apache Software
    Foundation. All other products or name brands are trademarks of their
    respective holders, including The Apache Software Foundation.
  </div>
</footer>

  </body>
</html>
