<!DOCTYPE html>
<!--
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at
   http://www.apache.org/licenses/LICENSE-2.0
 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License. See accompanying LICENSE file.
-->

<html lang="en">
  <!--
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at
   http://www.apache.org/licenses/LICENSE-2.0
 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License. See accompanying LICENSE file.
-->

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Beam Release Guide</title>
  <meta name="description" content="Apache Beam is an open source, unified model and set of language-specific SDKs for defining and executing data processing workflows, and also data ingestion and integration flows, supporting Enterprise Integration Patterns (EIPs) and Domain Specific Languages (DSLs). Dataflow pipelines simplify the mechanics of large-scale batch and streaming data processing and can run on a number of runtimes like Apache Flink, Apache Spark, and Google Cloud Dataflow (a cloud service). Beam also brings DSL in different languages, allowing users to easily implement their data integration processes.
">
  <link href="https://fonts.googleapis.com/css?family=Roboto:100,300,400" rel="stylesheet">
  <link rel="stylesheet" href="/css/site.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.0/jquery.min.js"></script>
  <script src="/js/bootstrap.min.js"></script>
  <script src="/js/language-switch.js"></script>
  <script src="/js/fix-menu.js"></script>
  <script src="/js/section-nav.js"></script>
  <script src="/js/page-nav.js"></script>
  <link rel="canonical" href="https://beam.apache.org/contribute/release-guide/" data-proofer-ignore>
  <link rel="shortcut icon" type="image/x-icon" href="/images/favicon.ico">
  <link rel="alternate" type="application/rss+xml" title="Apache Beam" href="https://beam.apache.org/feed.xml">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.4.1/css/all.css" integrity="sha384-5sAR7xN1Nv6T6+dT2mhtzEpVJvfS3NScPQTrOxhwjIuvcA67KV2R5Jz6kr4abQsz" crossorigin="anonymous">
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-73650088-1', 'auto');
    ga('send', 'pageview');
  </script>
</head>

  <body class="body" data-spy="scroll" data-target=".page-nav" data-offset="0">
    <!--
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at
   http://www.apache.org/licenses/LICENSE-2.0
 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License. See accompanying LICENSE file.
-->

<nav class="header navbar navbar-fixed-top">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" aria-expanded="false" aria-controls="navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <a href="/" class="navbar-brand" >
        <img alt="Brand" style="height: 25px" src="/images/beam_logo_navbar.png">
      </a>
    </div>

    <div class="navbar-mask closed"></div>

    <div id="navbar" class="navbar-container closed">
      <ul class="nav navbar-nav">
        <li>
          <a href="/get-started/beam-overview/">Get Started</a>
        </li>
        <li>
          <a href="/documentation/">Documentation</a>
        </li>
        <li>
          <a href="/documentation/sdks/java/">Languages</a>
        </li>
        <li>
          <a href="/documentation/runners/capability-matrix/">RUNNERS</a>
        </li>
        <li>
          <a href="/roadmap/">Roadmap</a>
        </li>
        <li>
          <a href="/contribute/">Contribute</a>
        </li>
        <li>
          <a href="/community/contact-us/">Community</a>
        </li>
        <li><a href="/blog">Blog</a></li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false"><img src="https://www.apache.org/foundation/press/kit/feather_small.png" alt="Apache Logo" style="height:20px;"><span class="caret"></span></a>
          <ul class="dropdown-menu dropdown-menu-right">
            <li><a href="http://www.apache.org/">ASF Homepage</a></li>
            <li><a href="http://www.apache.org/licenses/">License</a></li>
            <li><a href="http://www.apache.org/security/">Security</a></li>
            <li><a href="http://www.apache.org/foundation/thanks.html">Thanks</a></li>
            <li><a href="http://www.apache.org/foundation/sponsorship.html">Sponsorship</a></li>
            <li><a href="https://www.apache.org/foundation/policies/conduct">Code of Conduct</a></li>
          </ul>
        </li>
        <li>
          <!--
            data-proofer-ignore disables link checking from website test automation.
            GitHub links will not resolve until the markdown source is available on the master branch.
            New pages would fail validation during development / PR test automation.
          -->
          <a href="https://github.com/apache/beam/edit/master/website/src/contribute/release-guide.md" data-proofer-ignore>
            <i class="far fa-edit fa-lg" alt="Edit on GitHub" title="Edit on GitHub"></i>
          </a>
        </li>
      </ul>
    </div>
</nav>

    <div class="clearfix container-main-content">
      <div class="section-nav closed" data-offset-top="90" data-offset-bottom="500">
        <span class="section-nav-back glyphicon glyphicon-menu-left"></span>
        <nav>
          <ul class="section-nav-list" data-section-nav>
            <!--
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at
   http://www.apache.org/licenses/LICENSE-2.0
 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License. See accompanying LICENSE file.
-->

<li><span class="section-nav-list-main-title">Contribute</span></li>
<li><a href="/contribute/">Get started contributing</a></li>
<li><a href="/contribute/get-help/">Get Help</a></li>
<li>
  <span class="section-nav-list-title">Technical Docs</span>

  <ul class="section-nav-list">
    <li><a href="https://cwiki.apache.org/confluence/display/BEAM/Contribution+Testing+Guide">Testing guide</a></li>
    <li><a href="/contribute/precommit-triage-guide/">Pre-commit Slowness Triage</a></li>
    <li><a href="/contribute/ptransform-style-guide/">PTransform style guide</a></li>
    <li><a href="/contribute/runner-guide/">Runner authoring guide</a></li>
    <li><a href="/contribute/design-documents/">Design documents</a></li>
    <li><a href="/contribute/dependencies/">Dependencies guide</a></li>
    <li><a href="/contribute/feature-branches/">Feature branches</a></li>
  </ul>
</li>
<li>
  <span class="section-nav-list-title">Policies</span>
  <ul class="section-nav-list">
    <li><a href="/contribute/precommit-policies/">Pre-commit test policies</a></li>
    <li><a href="/contribute/postcommits-policies/">Post-commit test policies</a></li>
  </ul>
</li>
<li>
  <span class="section-nav-list-title">Committers</span>
  <ul class="section-nav-list">
    <li><a href="/contribute/become-a-committer/">Become a committer</a></li>
    <li><a href="/contribute/committer-guide/">Committer guide</a></li>
    <li><a href="/contribute/release-guide/">Release guide</a></li>
  </ul>
</li>

          </ul>
        </nav>
      </div>

      <nav class="page-nav clearfix" data-offset-top="90" data-offset-bottom="500">
        <!--
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at
   http://www.apache.org/licenses/LICENSE-2.0
 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License. See accompanying LICENSE file.
-->



<ul class="nav">
  <li><a href="#introduction">Introduction</a></li>
  <li><a href="#overview">Overview</a></li>
  <li><a href="#decide-to-release">Decide to release</a>
    <ul>
      <li><a href="#checklist-to-proceed-to-the-next-step">Checklist to proceed to the next step</a></li>
    </ul>
  </li>
  <li><a href="#prepare-for-the-release">Prepare for the release</a>
    <ul>
      <li><a href="#one-time-setup-instructions">One-time setup instructions</a></li>
      <li><a href="#create-a-new-version-in-jira">Create a new version in JIRA</a></li>
      <li><a href="#create-a-release-branch-in-apachebeam-repository">Create a release branch in apache/beam repository</a></li>
      <li><a href="#start-a-snapshot-build">Start a snapshot build</a></li>
      <li><a href="#verify-release-branch">Verify release branch</a></li>
      <li><a href="#update-and-verify-javadoc">Update and Verify Javadoc</a></li>
      <li><a href="#triage-release-blocking-issues-in-jira">Triage release-blocking issues in JIRA</a></li>
      <li><a href="#review-release-notes-in-jira">Review Release Notes in JIRA</a></li>
      <li><a href="#checklist-to-proceed-to-the-next-step-1">Checklist to proceed to the next step</a></li>
    </ul>
  </li>
  <li><a href="#build-a-release-candidate">Build a release candidate</a>
    <ul>
      <li><a href="#run-build_release_candidatesh-to-create-rc">Run build_release_candidate.sh to create RC</a></li>
      <li><a href="#run-all-steps-manually-1">Run all steps manually</a></li>
      <li><a href="#write-the-beam-blog-post-and-create-a-pull-request">Write the Beam blog post and create a pull request</a></li>
    </ul>
  </li>
  <li><a href="#vote-on-the-release-candidate">Vote on the release candidate</a>
    <ul>
      <li><a href="#run-validation-tests">Run validation tests</a></li>
      <li><a href="#checklist-to-proceed-to-the-finalization-step">Checklist to proceed to the finalization step</a></li>
    </ul>
  </li>
  <li><a href="#fix-any-issues">Fix any issues</a>
    <ul>
      <li><a href="#checklist-to-proceed-to-the-next-step-3">Checklist to proceed to the next step</a></li>
    </ul>
  </li>
  <li><a href="#finalize-the-release">Finalize the release</a>
    <ul>
      <li><a href="#deploy-artifacts-to-maven-central-repository">Deploy artifacts to Maven Central Repository</a></li>
      <li><a href="#deploy-python-artifacts-to-pypi">Deploy Python artifacts to PyPI</a></li>
      <li><a href="#git-tag">Git tag</a></li>
      <li><a href="#merge-website-pull-request">Merge website pull request</a></li>
      <li><a href="#mark-the-version-as-released-in-jira">Mark the version as released in JIRA</a></li>
      <li><a href="#recordkeeping-with-asf">Recordkeeping with ASF</a></li>
      <li><a href="#checklist-to-proceed-to-the-next-step-4">Checklist to proceed to the next step</a></li>
    </ul>
  </li>
  <li><a href="#promote-the-release">Promote the release</a>
    <ul>
      <li><a href="#apache-mailing-lists">Apache mailing lists</a></li>
      <li><a href="#social-media">Social media</a></li>
      <li><a href="#checklist-to-declare-the-process-completed">Checklist to declare the process completed</a></li>
    </ul>
  </li>
  <li><a href="#improve-the-process">Improve the process</a></li>
</ul>


      </nav>

      <div class="body__contained body__section-nav">
        <!--
Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
-->

<h1 id="apache-beam-release-guide">Apache Beam Release Guide</h1>

<ul id="markdown-toc">
  <li><a href="#introduction" id="markdown-toc-introduction">Introduction</a></li>
  <li><a href="#overview" id="markdown-toc-overview">Overview</a></li>
  <li><a href="#decide-to-release" id="markdown-toc-decide-to-release">Decide to release</a>    <ul>
      <li><a href="#checklist-to-proceed-to-the-next-step" id="markdown-toc-checklist-to-proceed-to-the-next-step">Checklist to proceed to the next step</a></li>
    </ul>
  </li>
  <li><a href="#prepare-for-the-release" id="markdown-toc-prepare-for-the-release">Prepare for the release</a>    <ul>
      <li><a href="#one-time-setup-instructions" id="markdown-toc-one-time-setup-instructions">One-time setup instructions</a>        <ul>
          <li><a href="#gpg-key" id="markdown-toc-gpg-key">GPG Key</a>            <ul>
              <li><a href="#use-preparation_before_releasesh-to-setup-gpg" id="markdown-toc-use-preparation_before_releasesh-to-setup-gpg">Use preparation_before_release.sh to setup GPG</a></li>
              <li><a href="#run-all-commands-manually" id="markdown-toc-run-all-commands-manually">Run all commands manually</a></li>
            </ul>
          </li>
          <li><a href="#access-to-apache-nexus-repository" id="markdown-toc-access-to-apache-nexus-repository">Access to Apache Nexus repository</a></li>
          <li><a href="#submit-your-gpg-public-key-into-mit-pgp-public-key-server" id="markdown-toc-submit-your-gpg-public-key-into-mit-pgp-public-key-server">Submit your GPG public key into MIT PGP Public Key Server</a></li>
          <li><a href="#website-development-setup" id="markdown-toc-website-development-setup">Website development setup</a></li>
          <li><a href="#register-to-pypi" id="markdown-toc-register-to-pypi">Register to PyPI</a></li>
        </ul>
      </li>
      <li><a href="#create-a-new-version-in-jira" id="markdown-toc-create-a-new-version-in-jira">Create a new version in JIRA</a></li>
      <li><a href="#create-a-release-branch-in-apachebeam-repository" id="markdown-toc-create-a-release-branch-in-apachebeam-repository">Create a release branch in apache/beam repository</a>        <ul>
          <li><a href="#use-cut_release_branchsh-to-cut-a-release-branch" id="markdown-toc-use-cut_release_branchsh-to-cut-a-release-branch">Use cut_release_branch.sh to cut a release branch</a></li>
          <li><a href="#run-all-steps-manually" id="markdown-toc-run-all-steps-manually">Run all steps manually</a></li>
        </ul>
      </li>
      <li><a href="#start-a-snapshot-build" id="markdown-toc-start-a-snapshot-build">Start a snapshot build</a>        <ul>
          <li><a href="#run-start_snapshot_buildsh-to-trigger-build" id="markdown-toc-run-start_snapshot_buildsh-to-trigger-build">Run start_snapshot_build.sh to trigger build</a></li>
          <li><a href="#do-all-operations-manually" id="markdown-toc-do-all-operations-manually">Do all operations manually</a></li>
        </ul>
      </li>
      <li><a href="#verify-release-branch" id="markdown-toc-verify-release-branch">Verify release branch</a>        <ul>
          <li><a href="#run-automation-script-verify_release_buildsh" id="markdown-toc-run-automation-script-verify_release_buildsh">Run automation script (verify_release_build.sh)</a></li>
          <li><a href="#run-all-commands-manually-1" id="markdown-toc-run-all-commands-manually-1">Run all commands manually</a></li>
          <li><a href="#create-release-blocking-issues-in-jira" id="markdown-toc-create-release-blocking-issues-in-jira">Create release-blocking issues in JIRA</a></li>
        </ul>
      </li>
      <li><a href="#update-and-verify-javadoc" id="markdown-toc-update-and-verify-javadoc">Update and Verify Javadoc</a></li>
      <li><a href="#triage-release-blocking-issues-in-jira" id="markdown-toc-triage-release-blocking-issues-in-jira">Triage release-blocking issues in JIRA</a></li>
      <li><a href="#review-release-notes-in-jira" id="markdown-toc-review-release-notes-in-jira">Review Release Notes in JIRA</a></li>
      <li><a href="#checklist-to-proceed-to-the-next-step-1" id="markdown-toc-checklist-to-proceed-to-the-next-step-1">Checklist to proceed to the next step</a></li>
    </ul>
  </li>
  <li><a href="#build-a-release-candidate" id="markdown-toc-build-a-release-candidate">Build a release candidate</a>    <ul>
      <li><a href="#run-build_release_candidatesh-to-create-rc" id="markdown-toc-run-build_release_candidatesh-to-create-rc">Run build_release_candidate.sh to create RC</a></li>
      <li><a href="#run-all-steps-manually-1" id="markdown-toc-run-all-steps-manually-1">Run all steps manually</a>        <ul>
          <li><a href="#build-and-stage-java-artifacts-with-gradle" id="markdown-toc-build-and-stage-java-artifacts-with-gradle">Build and stage Java artifacts with Gradle</a></li>
          <li><a href="#stage-source-release-on-distapacheorg" id="markdown-toc-stage-source-release-on-distapacheorg">Stage source release on dist.apache.org</a></li>
          <li><a href="#stage-python-binaries-on-distapacheorg" id="markdown-toc-stage-python-binaries-on-distapacheorg">Stage python binaries on dist.apache.org</a></li>
          <li><a href="#build-the-pydoc-api-reference" id="markdown-toc-build-the-pydoc-api-reference">Build the Pydoc API reference</a></li>
          <li><a href="#propose-pull-requests-for-website-updates" id="markdown-toc-propose-pull-requests-for-website-updates">Propose pull requests for website updates</a></li>
          <li><a href="#build-and-stage-python-wheels" id="markdown-toc-build-and-stage-python-wheels">Build and stage python wheels</a></li>
        </ul>
      </li>
      <li><a href="#write-the-beam-blog-post-and-create-a-pull-request" id="markdown-toc-write-the-beam-blog-post-and-create-a-pull-request">Write the Beam blog post and create a pull request</a>        <ul>
          <li><a href="#checklist-to-proceed-to-the-next-step-2" id="markdown-toc-checklist-to-proceed-to-the-next-step-2">Checklist to proceed to the next step</a></li>
        </ul>
      </li>
    </ul>
  </li>
  <li><a href="#vote-on-the-release-candidate" id="markdown-toc-vote-on-the-release-candidate">Vote on the release candidate</a>    <ul>
      <li><a href="#run-validation-tests" id="markdown-toc-run-validation-tests">Run validation tests</a>        <ul>
          <li><a href="#run-validations-using-run_rc_validationsh" id="markdown-toc-run-validations-using-run_rc_validationsh">Run validations using run_rc_validation.sh</a></li>
          <li><a href="#run-validations-manually" id="markdown-toc-run-validations-manually">Run validations manually</a></li>
        </ul>
      </li>
      <li><a href="#checklist-to-proceed-to-the-finalization-step" id="markdown-toc-checklist-to-proceed-to-the-finalization-step">Checklist to proceed to the finalization step</a></li>
    </ul>
  </li>
  <li><a href="#fix-any-issues" id="markdown-toc-fix-any-issues">Fix any issues</a>    <ul>
      <li><a href="#checklist-to-proceed-to-the-next-step-3" id="markdown-toc-checklist-to-proceed-to-the-next-step-3">Checklist to proceed to the next step</a></li>
    </ul>
  </li>
  <li><a href="#finalize-the-release" id="markdown-toc-finalize-the-release">Finalize the release</a>    <ul>
      <li><a href="#deploy-artifacts-to-maven-central-repository" id="markdown-toc-deploy-artifacts-to-maven-central-repository">Deploy artifacts to Maven Central Repository</a></li>
      <li><a href="#deploy-python-artifacts-to-pypi" id="markdown-toc-deploy-python-artifacts-to-pypi">Deploy Python artifacts to PyPI</a>        <ul>
          <li><a href="#deploy-source-release-to-distapacheorg" id="markdown-toc-deploy-source-release-to-distapacheorg">Deploy source release to dist.apache.org</a></li>
        </ul>
      </li>
      <li><a href="#git-tag" id="markdown-toc-git-tag">Git tag</a></li>
      <li><a href="#merge-website-pull-request" id="markdown-toc-merge-website-pull-request">Merge website pull request</a></li>
      <li><a href="#mark-the-version-as-released-in-jira" id="markdown-toc-mark-the-version-as-released-in-jira">Mark the version as released in JIRA</a></li>
      <li><a href="#recordkeeping-with-asf" id="markdown-toc-recordkeeping-with-asf">Recordkeeping with ASF</a></li>
      <li><a href="#checklist-to-proceed-to-the-next-step-4" id="markdown-toc-checklist-to-proceed-to-the-next-step-4">Checklist to proceed to the next step</a></li>
    </ul>
  </li>
  <li><a href="#promote-the-release" id="markdown-toc-promote-the-release">Promote the release</a>    <ul>
      <li><a href="#apache-mailing-lists" id="markdown-toc-apache-mailing-lists">Apache mailing lists</a></li>
      <li><a href="#social-media" id="markdown-toc-social-media">Social media</a></li>
      <li><a href="#checklist-to-declare-the-process-completed" id="markdown-toc-checklist-to-declare-the-process-completed">Checklist to declare the process completed</a></li>
    </ul>
  </li>
  <li><a href="#improve-the-process" id="markdown-toc-improve-the-process">Improve the process</a></li>
</ul>

<h2 id="introduction">Introduction</h2>

<p>The Apache Beam project periodically declares and publishes releases. A release is one or more packages of the project artifact(s) that are approved for general public distribution and use. They may come with various degrees of caveat regarding their perceived quality and potential for change, such as “alpha”, “beta”, “incubating”, “stable”, etc.</p>

<p>The Beam community treats releases with great importance. They are a public face of the project and most users interact with the project only through the releases. Releases are signed off by the entire Beam community in a public vote.</p>

<p>Each release is executed by a <em>Release Manager</em>, who is selected among the Beam committers. This document describes the process that the Release Manager follows to perform a release. Any changes to this process should be discussed and adopted on the <a href="/get-started/support/">dev@ mailing list</a>.</p>

<p>Please remember that publishing software has legal consequences. This guide complements the foundation-wide <a href="http://www.apache.org/dev/release.html">Product Release Policy</a> and <a href="http://www.apache.org/dev/release-distribution">Release Distribution Policy</a>.</p>

<h2 id="overview">Overview</h2>

<p><img src="/images/release-guide-1.png" alt="Alt text" title="Release Process" width="100%" /></p>

<p>The release process consists of several steps:</p>

<ol>
  <li>Decide to release</li>
  <li>Prepare for the release</li>
  <li>Build a release candidate</li>
  <li>Vote on the release candidate</li>
  <li>During vote process, run validation tests</li>
  <li>If necessary, fix any issues and go back to step 3.</li>
  <li>Finalize the release</li>
  <li>Promote the release</li>
</ol>

<hr />

<h2 id="decide-to-release">Decide to release</h2>

<p>Deciding to release and selecting a Release Manager is the first step of the release process. This is a consensus-based decision of the entire community.</p>

<p>Anybody can propose a release on the dev@ mailing list, giving a solid argument and nominating a committer as the Release Manager (including themselves). There’s no formal process, no vote requirements, and no timing requirements. Any objections should be resolved by consensus before starting the release.</p>

<p>In general, the community prefers to have a rotating set of 3-5 Release Managers. Keeping a small core set of managers allows enough people to build expertise in this area and improve processes over time, without Release Managers needing to re-learn the processes for each release. That said, if you are a committer interested in serving the community in this way, please reach out to the community on the dev@ mailing list.</p>

<h3 id="checklist-to-proceed-to-the-next-step">Checklist to proceed to the next step</h3>

<ol>
  <li>Community agrees to release</li>
  <li>Community selects a Release Manager</li>
</ol>

<hr />

<h2 id="prepare-for-the-release">Prepare for the release</h2>

<p>Before your first release, you should perform one-time configuration steps. This will set up your security keys for signing the release and access to various release repositories.</p>

<p>To prepare for each release, you should audit the project status in the JIRA issue tracker, and do necessary bookkeeping. Finally, you should create a release branch from which individual release candidates will be built.</p>

<p><strong>NOTE</strong>: If you are using <a href="https://help.github.com/articles/securing-your-account-with-two-factor-authentication-2fa/">GitHub two-factor authentication</a> and haven’t configure HTTPS access, 
please follow <a href="https://help.github.com/articles/creating-a-personal-access-token-for-the-command-line/">the guide</a> to configure command line access.</p>

<h3 id="one-time-setup-instructions">One-time setup instructions</h3>

<h4 id="gpg-key">GPG Key</h4>

<p>You need to have a GPG key to sign the release artifacts. Please be aware of the ASF-wide <a href="https://www.apache.org/dev/release-signing.html">release signing guidelines</a>. If you don’t have a GPG key associated with your Apache account, please create one according to the guidelines.</p>

<p>There are 2 ways to configure your GPG key for release, either using release automation script(which is recommended), 
or running all commands manually.</p>

<h5 id="use-preparation_before_releasesh-to-setup-gpg">Use preparation_before_release.sh to setup GPG</h5>
<ul>
  <li>
    <p>Script: <a href="https://github.com/apache/beam/blob/master/release/src/main/scripts/preparation_before_release.sh">preparation_before_release.sh</a></p>
  </li>
  <li>Usage
    <div class="highlighter-rouge"><pre class="highlight"><code>./beam/release/src/main/scripts/preparation_before_release.sh
</code></pre>
    </div>
  </li>
  <li>Tasks included
    <ol>
      <li>Help you create a new GPG key if you want.</li>
      <li>Configure <code class="highlighter-rouge">git user.signingkey</code> with chosen pubkey.</li>
      <li>
        <p>Add chosen pubkey into <a href="https://dist.apache.org/repos/dist/dev/beam/KEYS">dev KEYS</a>  and <a href="https://dist.apache.org/repos/dist/release/beam/KEYS">release KEYS</a></p>

        <p><strong>NOTES</strong>: Only PMC can write into <a href="https://dist.apache.org/repos/dist/release/beam/">release repo</a>.</p>
      </li>
      <li>Start GPG agents.</li>
    </ol>
  </li>
</ul>

<h5 id="run-all-commands-manually">Run all commands manually</h5>

<ul>
  <li>
    <p>Get more entropy for creating a GPG key</p>

    <div class="highlighter-rouge"><pre class="highlight"><code>sudo apt-get install rng-tools
sudo rngd -r /dev/urandom
</code></pre>
    </div>
  </li>
  <li>
    <p>Create a GPG key</p>

    <div class="highlighter-rouge"><pre class="highlight"><code>gpg --full-generate-key
</code></pre>
    </div>
  </li>
  <li>
    <p>Determine your Apache GPG Key and Key ID, as follows:</p>

    <div class="highlighter-rouge"><pre class="highlight"><code>gpg --list-keys
</code></pre>
    </div>

    <p>This will list your GPG keys. One of these should reflect your Apache account, for example:</p>

    <div class="highlighter-rouge"><pre class="highlight"><code>--------------------------------------------------
pub   2048R/845E6689 2016-02-23
uid                  Nomen Nescio &lt;anonymous@apache.org&gt;
sub   2048R/BA4D50BE 2016-02-23
</code></pre>
    </div>

    <p>Here, the key ID is the 8-digit hex string in the <code class="highlighter-rouge">pub</code> line: <code class="highlighter-rouge">845E6689</code>.</p>

    <p>Now, add your Apache GPG key to the Beam’s <code class="highlighter-rouge">KEYS</code> file both in <a href="https://dist.apache.org/repos/dist/dev/beam/KEYS"><code class="highlighter-rouge">dev</code></a> and <a href="https://dist.apache.org/repos/dist/release/beam/KEYS"><code class="highlighter-rouge">release</code></a> repositories at <code class="highlighter-rouge">dist.apache.org</code>. Follow the instructions listed at the top of these files. (Note: Only PMC members have write access to the release repository. If you end up getting 403 errors ask on the mailing list for assistance.)</p>
  </li>
  <li>
    <p>Configure <code class="highlighter-rouge">git</code> to use this key when signing code by giving it your key ID, as follows:</p>

    <div class="highlighter-rouge"><pre class="highlight"><code>git config --global user.signingkey 845E6689
</code></pre>
    </div>

    <p>You may drop the <code class="highlighter-rouge">--global</code> option if you’d prefer to use this key for the current repository only.</p>
  </li>
  <li>
    <p>Start GPG agent in order to unlock your GPG key</p>

    <div class="highlighter-rouge"><pre class="highlight"><code>eval $(gpg-agent --daemon --no-grab --write-env-file $HOME/.gpg-agent-info)
export GPG_TTY=$(tty)
export GPG_AGENT_INFO
</code></pre>
    </div>
  </li>
</ul>

<h4 id="access-to-apache-nexus-repository">Access to Apache Nexus repository</h4>

<p>Configure access to the <a href="http://repository.apache.org/">Apache Nexus repository</a>, which enables final deployment of releases to the Maven Central Repository.</p>

<ol>
  <li>You log in with your Apache account.</li>
  <li>Confirm you have appropriate access by finding <code class="highlighter-rouge">org.apache.beam</code> under <code class="highlighter-rouge">Staging Profiles</code>.</li>
  <li>Navigate to your <code class="highlighter-rouge">Profile</code> (top right dropdown menu of the page).</li>
  <li>Choose <code class="highlighter-rouge">User Token</code> from the dropdown, then click <code class="highlighter-rouge">Access User Token</code>. Copy a snippet of the Maven XML configuration block.</li>
  <li>
    <p>Insert this snippet twice into your global Maven <code class="highlighter-rouge">settings.xml</code> file, typically <code class="highlighter-rouge">${HOME}/.m2/settings.xml</code>. The end result should look like this, where <code class="highlighter-rouge">TOKEN_NAME</code> and <code class="highlighter-rouge">TOKEN_PASSWORD</code> are your secret tokens:</p>

    <div class="highlighter-rouge"><pre class="highlight"><code> &lt;settings&gt;
   &lt;servers&gt;
     &lt;server&gt;
       &lt;id&gt;apache.releases.https&lt;/id&gt;
       &lt;username&gt;TOKEN_NAME&lt;/username&gt;
       &lt;password&gt;TOKEN_PASSWORD&lt;/password&gt;
     &lt;/server&gt;
     &lt;server&gt;
       &lt;id&gt;apache.snapshots.https&lt;/id&gt;
       &lt;username&gt;TOKEN_NAME&lt;/username&gt;
       &lt;password&gt;TOKEN_PASSWORD&lt;/password&gt;
     &lt;/server&gt;
   &lt;/servers&gt;
 &lt;/settings&gt;
</code></pre>
    </div>
  </li>
</ol>

<h4 id="submit-your-gpg-public-key-into-mit-pgp-public-key-server">Submit your GPG public key into MIT PGP Public Key Server</h4>
<p>In order to make yourself have right permission to stage java artifacts in Apache Nexus staging repository, 
please submit your GPG public key into <a href="http://pgp.mit.edu:11371/">MIT PGP Public Key Server</a>.</p>

<h4 id="website-development-setup">Website development setup</h4>

<p>Updating the Beam website requires submitting PRs to both the main <code class="highlighter-rouge">apache/beam</code>
repo and the <code class="highlighter-rouge">apache/beam-site</code> repo. The first contains reference manuals
generated from SDK code, while the second updates the current release version
number.</p>

<p>You should already have setup a local clone of <code class="highlighter-rouge">apache/beam</code>. Setting up a clone
of <code class="highlighter-rouge">apache/beam-site</code> is similar:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>$ git clone -b release-docs https://github.com/apache/beam-site.git
$ cd beam-site
$ git remote add &lt;GitHub_user&gt; git@github.com:&lt;GitHub_user&gt;/beam-site.git
$ git fetch --all
$ git checkout -b &lt;my-branch&gt; origin/release-docs
</code></pre>
</div>

<p>Further instructions on website development on <code class="highlighter-rouge">apache/beam</code> is
<a href="https://github.com/apache/beam/blob/master/website">here</a>. Background
information about how the website is updated can be found in <a href="https://s.apache.org/beam-site-automation">Beam-Site
Automation Reliability</a>.</p>

<h4 id="register-to-pypi">Register to PyPI</h4>

<p>Release manager needs to have an account with PyPI. If you need one, <a href="https://pypi.python.org/account/register/">register at PyPI</a>. You also need to be a maintainer (or an owner) of the <a href="https://pypi.python.org/pypi/apache-beam">apache-beam</a> package in order to push a new release. Ask on the mailing list for assistance.</p>

<h3 id="create-a-new-version-in-jira">Create a new version in JIRA</h3>

<p>When contributors resolve an issue in JIRA, they are tagging it with a release that will contain their changes. With the release currently underway, new issues should be resolved against a subsequent future release. Therefore, you should create a release item for this subsequent release, as follows:</p>

<p><strong>Attention</strong>: Only PMC has permission to perform this. If you are not a PMC, please ask for help in dev@ mailing list.</p>

<ol>
  <li>In JIRA, navigate to <a href="https://issues.apache.org/jira/plugins/servlet/project-config/BEAM/versions"><code class="highlighter-rouge">Beam &gt; Administration &gt; Versions</code></a>.</li>
  <li>Add a new release. Choose the next minor version number after the version currently underway, select the release cut date (today’s date) as the <code class="highlighter-rouge">Start Date</code>, and choose <code class="highlighter-rouge">Add</code>.</li>
  <li>At the end of the release, go to the same page and mark the recently released version as released. Use the <code class="highlighter-rouge">...</code> menu and choose <code class="highlighter-rouge">Release</code>.</li>
</ol>

<h3 id="create-a-release-branch-in-apachebeam-repository">Create a release branch in apache/beam repository</h3>

<p>Attention: Only committer has permission to create release branch in apache/beam.</p>

<p>Release candidates are built from a release branch. As a final step in preparation for the release, you should create the release branch, push it to the Apache code repository, and update version information on the original branch.</p>

<p>There are 2 ways to cut a release branch: either running automation script(recommended), or running all commands manually.</p>

<h4 id="use-cut_release_branchsh-to-cut-a-release-branch">Use cut_release_branch.sh to cut a release branch</h4>
<ul>
  <li>
    <p>Script: <a href="https://github.com/apache/beam/blob/master/release/src/main/scripts/cut_release_branch.sh">cut_release_branch.sh</a></p>
  </li>
  <li>Usage
    <div class="highlighter-rouge"><pre class="highlight"><code># Cut a release branch
./beam/release/src/main/scripts/cut_release_branch.sh \
--release=${RELEASE_VERSION} \
--next_release=${NEXT_VERSION}
  
# Show help page
./beam/release/src/main/scripts/cut_release_branch.sh -h
</code></pre>
    </div>
  </li>
  <li>Tasks included
    <ol>
      <li>Create release-${RELEASE_VERSION} branch locally.</li>
      <li>
        <p>Change and commit dev versoin number in master branch:</p>

        <p><a href="https://github.com/apache/beam/blob/e8abafe360e126818fe80ae0f6075e71f0fc227d/buildSrc/src/main/groovy/org/apache/beam/gradle/BeamModulePlugin.groovy#L209">BeamModulePlugin.groovy</a>,
<a href="https://github.com/apache/beam/blob/e8abafe360e126818fe80ae0f6075e71f0fc227d/gradle.properties#L25">gradle.properties</a>,
<a href="https://github.com/apache/beam/blob/e8abafe360e126818fe80ae0f6075e71f0fc227d/sdks/python/apache_beam/version.py#L21">version.py</a></p>
      </li>
      <li>
        <p>Change and commit version number in release branch:</p>

        <p><a href="https://github.com/apache/beam/blob/release-2.6.0/sdks/python/apache_beam/version.py#L21">version.py</a>, 
<a href="https://github.com/apache/beam/blob/release-2.6.0/runners/google-cloud-dataflow-java/build.gradle#L39">build.gradle</a></p>
      </li>
    </ol>
  </li>
</ul>

<h4 id="run-all-steps-manually">Run all steps manually</h4>
<ul>
  <li>
    <p>Checkout working branch</p>

    <p>Check out the version of the codebase from which you start the release. For a new minor or major release, this may be <code class="highlighter-rouge">HEAD</code> of the <code class="highlighter-rouge">master</code> branch. To build a hotfix/incremental release, instead of the <code class="highlighter-rouge">master</code> branch, use the release tag of the release being patched. (Please make sure your cloned repository is up-to-date before starting.)</p>

    <div class="highlighter-rouge"><pre class="highlight"><code>git checkout &lt;master branch OR release tag&gt;
</code></pre>
    </div>

    <p><strong>NOTE</strong>: If you are doing an incremental/hotfix release (e.g. 2.5.1), please check out the previous release tag, rather than the master branch.</p>
  </li>
  <li>
    <p>Set up environment variables</p>

    <p>Set up a few environment variables to simplify Maven commands that follow. (We use <code class="highlighter-rouge">bash</code> Unix syntax in this guide.)</p>

    <div class="highlighter-rouge"><pre class="highlight"><code>RELEASE=2.5.0
NEXT_VERSION_IN_BASE_BRANCH=2.6.0
BRANCH=release-${RELEASE}
</code></pre>
    </div>

    <p>Version represents the release currently underway, while next version specifies the anticipated next version to be released from that branch. Normally, 1.2.0 is followed by 1.3.0, while 1.2.3 is followed by 1.2.4.</p>

    <p><strong>NOTE</strong>: Only if you are doing an incremental/hotfix release (e.g. 2.5.1), please check out the previous release tag, before running the following instructions:</p>

    <div class="highlighter-rouge"><pre class="highlight"><code>BASE_RELEASE=2.5.0
RELEASE=2.5.1
NEXT_VERSION_IN_BASE_BRANCH=2.6.0
git checkout tags/${BASE_RELEASE}
</code></pre>
    </div>
  </li>
  <li>
    <p>Create release branch locally</p>

    <div class="highlighter-rouge"><pre class="highlight"><code>git branch ${BRANCH}
</code></pre>
    </div>
  </li>
  <li>
    <p>Update version files in the master branch.</p>

    <div class="highlighter-rouge"><pre class="highlight"><code># Now change the version in existing gradle files, and Python files
sed -i -e "s/'${RELEASE}'/'${NEXT_VERSION_IN_BASE_BRANCH}'/g" build_rules.gradle
sed -i -e "s/${RELEASE}/${NEXT_VERSION_IN_BASE_BRANCH}/g" gradle.properties
sed -i -e "s/${RELEASE}/${NEXT_VERSION_IN_BASE_BRANCH}/g" sdks/python/apache_beam/version.py
  
# Save changes in master branch
git add gradle.properties build_rules.gradle sdks/python/apache_beam/version.py
git commit -m "Moving to ${NEXT_VERSION_IN_BASE_BRANCH}-SNAPSHOT on master branch."
</code></pre>
    </div>
  </li>
  <li>
    <p>Check out the release branch.</p>

    <div class="highlighter-rouge"><pre class="highlight"><code>git checkout ${BRANCH}
</code></pre>
    </div>
  </li>
  <li>
    <p>Update version files in release branch</p>

    <div class="highlighter-rouge"><pre class="highlight"><code>DEV=${RELEASE}.dev
sed -i -e "s/${DEV}/${RELEASE}/g" sdks/python/apache_beam/version.py
sed -i -e "s/'beam-master-.*'/'beam-${RELEASE}'/g" runners/google-cloud-dataflow-java/build.gradle
</code></pre>
    </div>
  </li>
</ul>

<h3 id="start-a-snapshot-build">Start a snapshot build</h3>

<p>Start a build of <a href="https://builds.apache.org/view/A-D/view/Beam/job/beam_Release_NightlySnapshot/">the nightly snapshot</a> against master branch.
Some processes, including our archetype tests, rely on having a live SNAPSHOT of the current version
from the <code class="highlighter-rouge">master</code> branch. Once the release branch is cut, these SNAPSHOT versions are no longer found,
so builds will be broken until a new snapshot is available.</p>

<p>There are 2 ways to trigger a nightly build, either using automation script(recommended), or perform all operations manually.</p>

<h4 id="run-start_snapshot_buildsh-to-trigger-build">Run start_snapshot_build.sh to trigger build</h4>
<ul>
  <li>
    <p>Script: <a href="https://github.com/apache/beam/blob/master/release/src/main/scripts/start_snapshot_build.sh">start_snapshot_build.sh</a></p>
  </li>
  <li>
    <p>Usage</p>

    <div class="highlighter-rouge"><pre class="highlight"><code>./beam/release/src/main/scripts/start_snapshot_build.sh
</code></pre>
    </div>
  </li>
  <li>Tasks included
    <ol>
      <li>Install <a href="https://github.com/github/hub">hub</a> with your agreement.</li>
      <li>Touch an empty txt file and commit changes into <code class="highlighter-rouge">${your remote beam repo}/snapshot_build</code></li>
      <li>Use hub to create a PR against apache:master, which triggers a Jenkins job to build snapshot.</li>
    </ol>
  </li>
  <li>Tasks you need to do manually
    <ol>
      <li>Check whether the Jenkins job gets triggered. If not, please comment <code class="highlighter-rouge">Run Gradle Publish</code> into the generated PR.</li>
      <li>After verifying build succeeded, you need to close PR manually.</li>
    </ol>
  </li>
</ul>

<h4 id="do-all-operations-manually">Do all operations manually</h4>

<ul>
  <li>Find one PR against apache:master in beam.</li>
  <li>Comment  <code class="highlighter-rouge">Run Gradle Publish</code> in this pull request to trigger build.</li>
  <li>Verify that build succeeds.</li>
</ul>

<h3 id="verify-release-branch">Verify release branch</h3>

<p>There are 2 ways to perform this verification, either running automation script(recommended), or running all commands manually.</p>

<h4 id="run-automation-script-verify_release_buildsh">Run automation script (verify_release_build.sh)</h4>
<ul>
  <li>
    <p>Script: <a href="https://github.com/apache/beam/blob/master/release/src/main/scripts/verify_release_build.sh">verify_release_build.sh</a></p>
  </li>
  <li>
    <p>Usage</p>

    <div class="highlighter-rouge"><pre class="highlight"><code>```
./beam/release/src/main/scripts/verify_release_build.sh
```
</code></pre>
    </div>
  </li>
  <li>Tasks included
    <ol>
      <li>Install <code class="highlighter-rouge">pip</code>, <code class="highlighter-rouge">virtualenv</code>, <code class="highlighter-rouge">cython</code> and <code class="highlighter-rouge">/usr/bin/time</code> with your agreements.</li>
      <li>Run <code class="highlighter-rouge">gradle release build</code> against release branch.</li>
    </ol>
  </li>
  <li>Tasks you need to do manually
    <ol>
      <li>Check the build result.</li>
      <li>If build failed, scan log will contain all failures.</li>
      <li>You should stabilize the release branch until release build succeeded.</li>
      <li>The script will output a set of Jenkins phrases to enter in the created PR</li>
    </ol>
  </li>
</ul>

<h4 id="run-all-commands-manually-1">Run all commands manually</h4>
<ul>
  <li>Pre-installation for python build
    <ol>
      <li>
        <p>Install pip</p>

        <div class="highlighter-rouge"><pre class="highlight"><code> curl https://bootstrap.pypa.io/get-pip.py -o get-pip.py
 python get-pip.py
</code></pre>
        </div>
      </li>
      <li>
        <p>Install virtualenv</p>

        <div class="highlighter-rouge"><pre class="highlight"><code> pip install --upgrade virtualenv
</code></pre>
        </div>
      </li>
      <li>
        <p>Cython</p>

        <div class="highlighter-rouge"><pre class="highlight"><code> sudo pip install cython
 sudo apt-get install gcc
 sudo apt-get install python-dev
 sudo apt-get install python3-dev
 sudo apt-get install python3.5-dev
 sudo apt-get install python3.6-dev
 sudo apt-get install python3.7-dev
</code></pre>
        </div>
      </li>
      <li>
        <p>Make sure your <code class="highlighter-rouge">time</code> alias to <code class="highlighter-rouge">/usr/bin/time</code>, if not:</p>

        <div class="highlighter-rouge"><pre class="highlight"><code> sudo apt-get install time
 alias time='/usr/bin/time'
</code></pre>
        </div>
      </li>
    </ol>
  </li>
  <li>
    <p>Run gradle release build</p>

    <ol>
      <li>
        <p>Clean current workspace</p>

        <div class="highlighter-rouge"><pre class="highlight"><code> git clean -fdx 
 ./gradlew clean
</code></pre>
        </div>
      </li>
      <li>Unlock the secret key
        <div class="highlighter-rouge"><pre class="highlight"><code> gpg --output ~/doc.sig --sign ~/.bashrc
</code></pre>
        </div>
      </li>
      <li>Run build command
        <div class="highlighter-rouge"><pre class="highlight"><code>./gradlew build -PisRelease --no-parallel --scan --stacktrace --continue
</code></pre>
        </div>
      </li>
    </ol>
  </li>
</ul>

<h4 id="create-release-blocking-issues-in-jira">Create release-blocking issues in JIRA</h4>

<p>The verify_release_build.sh script may include failing or flaky tests. For each of the failing tests create a JIRA with the following properties:</p>

<ul>
  <li>
    <p>Issue Type: Bug</p>
  </li>
  <li>
    <p>Summary: Name of failing gradle task and name of failing test (where applicable) in form of :MyGradleProject:SomeGradleTask NameOfFailedTest: Short description of failure</p>
  </li>
  <li>
    <p>Priority: Major</p>
  </li>
  <li>
    <p>Component: “test-failures”</p>
  </li>
  <li>
    <p>Fix Version: Release number of verified release branch</p>
  </li>
  <li>
    <p>Description: Description of failure</p>
  </li>
</ul>

<h3 id="update-and-verify-javadoc">Update and Verify Javadoc</h3>

<p>The build with <code class="highlighter-rouge">-PisRelease</code> creates the combined Javadoc for the release in <code class="highlighter-rouge">sdks/java/javadoc</code>.</p>

<p>The file <code class="highlighter-rouge">sdks/java/javadoc/build.gradle</code> contains a list of modules to include
in and exclude, plus a list of offline URLs that populate links from Beam’s
Javadoc to the Javadoc for other modules that Beam depends on.</p>

<ul>
  <li>
    <p>Confirm that new modules added since the last release have been added to the
inclusion list as appropriate.</p>
  </li>
  <li>
    <p>Confirm that the excluded package list is up to date.</p>
  </li>
  <li>
    <p>Verify the version numbers for offline links match the versions used by Beam. If
the version number has changed, download a new version of the corresponding
<code class="highlighter-rouge">&lt;module&gt;-docs/package-list</code> file.</p>
  </li>
</ul>

<h3 id="triage-release-blocking-issues-in-jira">Triage release-blocking issues in JIRA</h3>

<p>There could be outstanding release-blocking issues, which should be triaged before proceeding to build a release candidate. We track them by assigning a specific <code class="highlighter-rouge">Fix version</code> field even before the issue resolved.</p>

<p>The list of release-blocking issues is available at the <a href="https://issues.apache.org/jira/browse/BEAM/?selectedTab=com.atlassian.jira.jira-projects-plugin:versions-panel">version status page</a>. Triage each unresolved issue with one of the following resolutions:</p>

<p>For all JIRA issues:</p>

<ul>
  <li>If the issue has been resolved and JIRA was not updated, resolve it accordingly.</li>
</ul>

<p>For JIRA issues with type “Bug” or labeled “flaky”:</p>

<ul>
  <li>If the issue is a known continuously failing test, it is not acceptable to defer this until the next release. Please work with the Beam community to resolve the issue.</li>
  <li>If the issue is a known flaky test, make an attempt to delegate a fix. However, if the issue may take too long to fix (to the discretion of the release manager):
    <ul>
      <li>Delegate manual testing of the flaky issue to ensure no release blocking issues.</li>
      <li>Update the <code class="highlighter-rouge">Fix Version</code> field to the version of the next release. Please consider discussing this with stakeholders and the dev@ mailing list, as appropriate.</li>
    </ul>
  </li>
</ul>

<p>For all other JIRA issues:</p>

<ul>
  <li>If the issue has not been resolved and it is acceptable to defer this until the next release, update the <code class="highlighter-rouge">Fix Version</code> field to the new version you just created. Please consider discussing this with stakeholders and the dev@ mailing list, as appropriate.</li>
  <li>If the issue has not been resolved and it is not acceptable to release until it is fixed, the release cannot proceed. Instead, work with the Beam community to resolve the issue.</li>
</ul>

<p>If there is a bug found in the RC creation process/tools, those issues should be considered high priority and fixed in 7 days.</p>

<h3 id="review-release-notes-in-jira">Review Release Notes in JIRA</h3>

<p>JIRA automatically generates Release Notes based on the <code class="highlighter-rouge">Fix Version</code> field applied to issues. Release Notes are intended for Beam users (not Beam committers/contributors). You should ensure that Release Notes are informative and useful.</p>

<p>Open the release notes from the <a href="https://issues.apache.org/jira/browse/BEAM/?selectedTab=com.atlassian.jira.jira-projects-plugin:versions-panel">version status page</a> by choosing the release underway and clicking Release Notes.</p>

<p>You should verify that the issues listed automatically by JIRA are appropriate to appear in the Release Notes. Specifically, issues should:</p>

<ul>
  <li>Be appropriately classified as <code class="highlighter-rouge">Bug</code>, <code class="highlighter-rouge">New Feature</code>, <code class="highlighter-rouge">Improvement</code>, etc.</li>
  <li>Represent noteworthy user-facing changes, such as new functionality, backward-incompatible API changes, or performance improvements.</li>
  <li>Have occurred since the previous release; an issue that was introduced and fixed between releases should not appear in the Release Notes.</li>
  <li>Have an issue title that makes sense when read on its own.</li>
</ul>

<p>Adjust any of the above properties to the improve clarity and presentation of the Release Notes.</p>

<h3 id="checklist-to-proceed-to-the-next-step-1">Checklist to proceed to the next step</h3>

<ul>
  <li>Release Manager’s GPG key is published to <code class="highlighter-rouge">dist.apache.org</code></li>
  <li>Release Manager’s GPG key is configured in <code class="highlighter-rouge">git</code> configuration</li>
  <li>Release Manager has <code class="highlighter-rouge">org.apache.beam</code> listed under <code class="highlighter-rouge">Staging Profiles</code> in Nexus</li>
  <li>Release Manager’s Nexus User Token is configured in <code class="highlighter-rouge">settings.xml</code></li>
  <li>JIRA release item for the subsequent release has been created</li>
  <li>All test failures from branch verification have associated JIRA issues</li>
  <li>There are no release blocking JIRA issues</li>
  <li>Release Notes in JIRA have been audited and adjusted</li>
  <li>Combined javadoc has the appropriate contents.</li>
  <li>Release branch has been created</li>
  <li>There are no open pull requests to release branch</li>
  <li>Originating branch has the version information updated to the new version</li>
  <li>Nightly snapshot is in progress (do revisit it continually)</li>
</ul>

<hr />

<h2 id="build-a-release-candidate">Build a release candidate</h2>

<p>The core of the release process is the build-vote-fix cycle. Each cycle produces one release candidate. The Release Manager repeats this cycle until the community approves one release candidate, which is then finalized.</p>

<p>For this step, we recommend you using automation script to create a RC, but you still can perform all steps manually if you want.</p>

<h3 id="run-build_release_candidatesh-to-create-rc">Run build_release_candidate.sh to create RC</h3>
<ul>
  <li>
    <p>Script: <a href="https://github.com/apache/beam/blob/master/release/src/main/scripts/build_release_candidate.sh">build_release_candidate.sh</a></p>
  </li>
  <li>
    <p>Usage</p>

    <div class="highlighter-rouge"><pre class="highlight"><code>./beam/release/src/main/scripts/build_release_candidate.sh
</code></pre>
    </div>
  </li>
  <li>Tasks included
    <ol>
      <li>Run gradle release to create rc tag and push source release into github repo.</li>
      <li>
        <p>Run gradle publish to push java artifacts into Maven staging repo.</p>

        <p><strong>NOTE</strong>: In order to public staging artifacts, you need to goto the staging repo to close the staging repository on Apache Nexus. 
When prompted for a description, enter “Apache Beam, version X, release candidate Y”.</p>
      </li>
      <li>Stage source release into dist.apache.org dev <a href="https://dist.apache.org/repos/dist/dev/beam/">repo</a>.</li>
      <li>Stage,sign and hash python binaries into dist.apache.ord dev repo python dir</li>
      <li>Create a PR to update beam and beam-site, changes includes:
        <ul>
          <li>Copy python doc into beam-site</li>
          <li>Copy java doc into beam-site</li>
          <li>Update release version into <a href="https://github.com/apache/beam/blob/master/website/_config.yml">_config.yml</a>.</li>
        </ul>
      </li>
    </ol>
  </li>
  <li>Tasks you need to do manually
    <ol>
      <li>Add new release into <code class="highlighter-rouge">website/src/get-started/downloads.md</code>.</li>
      <li>Update last release download links in <code class="highlighter-rouge">website/src/get-started/downloads.md</code>.</li>
      <li>Update <code class="highlighter-rouge">website/src/.htaccess</code> to redirect to the new version.</li>
      <li>Build and stage python wheels.</li>
    </ol>
  </li>
</ul>

<h3 id="run-all-steps-manually-1">Run all steps manually</h3>

<h4 id="build-and-stage-java-artifacts-with-gradle">Build and stage Java artifacts with Gradle</h4>

<p>Set up a few environment variables to simplify the commands that follow. These identify the release candidate being built, and the branch where you will stage files. Start with <code class="highlighter-rouge">RC_NUM</code> equal to <code class="highlighter-rouge">1</code> and increment it for each candidate.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>RC_NUM=1
</code></pre>
</div>

<p>Make sure your git config will maintain your account:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>git config credential.helper store
</code></pre>
</div>

<p>Use Gradle release plugin to build the release artifacts, and push code and
release tag to the origin repository (this would be the Apache Beam repo):</p>

<div class="highlighter-rouge"><pre class="highlight"><code>./gradlew release -Prelease.newVersion=${RELEASE}-SNAPSHOT \
              -Prelease.releaseVersion=${RELEASE}-RC${RC_NUM} \
              -Prelease.useAutomaticVersion=true --info --no-daemon
</code></pre>
</div>

<p>Use Gradle publish plugin to stage these artifacts on the Apache Nexus repository, as follows:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>./gradlew publish -PisRelease --no-parallel --no-daemon
</code></pre>
</div>

<p>Review all staged artifacts. They should contain all relevant parts for each module, including <code class="highlighter-rouge">pom.xml</code>, jar, test jar, javadoc, etc. Artifact names should follow <a href="https://search.maven.org/#search%7Cga%7C1%7Cg%3A%22org.apache.beam%22">the existing format</a> in which artifact name mirrors directory structure, e.g., <code class="highlighter-rouge">beam-sdks-java-io-kafka</code>. Carefully review any new artifacts.</p>

<p>Close the staging repository on Apache Nexus. When prompted for a description, enter “Apache Beam, version X, release candidate Y”.</p>

<h4 id="stage-source-release-on-distapacheorg">Stage source release on dist.apache.org</h4>

<p>Attention: Only committer has permissions to perform following steps.</p>

<p>Copy the source release to the dev repository of <code class="highlighter-rouge">dist.apache.org</code>.</p>

<ol>
  <li>
    <p>If you have not already, check out the Beam section of the <code class="highlighter-rouge">dev</code> repository on <code class="highlighter-rouge">dist.apache.org</code> via Subversion. In a fresh directory:</p>

    <div class="highlighter-rouge"><pre class="highlight"><code> svn co https://dist.apache.org/repos/dist/dev/beam
</code></pre>
    </div>
  </li>
  <li>
    <p>Make a directory for the new release:</p>

    <div class="highlighter-rouge"><pre class="highlight"><code> mkdir beam/${RELEASE}
 cd beam/${RELEASE}
</code></pre>
    </div>
  </li>
  <li>
    <p>Download source zip from GitHub:</p>

    <p>wget https://github.com/apache/beam/archive/release-${RELEASE}.zip \
      -O apache-beam-${RELEASE}-source-release.zip</p>
  </li>
  <li>
    <p>Create hashes and sign the source distribution:</p>

    <div class="highlighter-rouge"><pre class="highlight"><code> gpg --armor --detach-sig apache-beam-${RELEASE}-source-release.zip
 sha512sum apache-beam-${RELEASE}-source-release.zip &gt; apache-beam-${RELEASE}-source-release.zip.sha512
</code></pre>
    </div>
  </li>
  <li>
    <p>Add and commit all the files.</p>

    <div class="highlighter-rouge"><pre class="highlight"><code> svn add beam/${RELEASE}
 svn commit
</code></pre>
    </div>
  </li>
  <li>
    <p>Verify that files are <a href="https://dist.apache.org/repos/dist/dev/beam">present</a>.</p>
  </li>
</ol>

<h4 id="stage-python-binaries-on-distapacheorg">Stage python binaries on dist.apache.org</h4>

<p>Build python binaries in release branch in sdks/python dir.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>python setup.py sdist --format=zip
cd dist
cp apache-beam-${RELEASE}.zip staging/apache-beam-${RELEASE}-python.zip
cd staging
</code></pre>
</div>

<p>Create hashes and sign the binaries</p>

<div class="highlighter-rouge"><pre class="highlight"><code>gpg --armor --detach-sig apache-beam-${RELEASE}-python.zip
sha512sum apache-beam-${RELEASE}-python.zip &gt; apache-beam-${RELEASE}-python.zip.sha512
</code></pre>
</div>

<p>Staging binaries</p>

<div class="highlighter-rouge"><pre class="highlight"><code>svn co https://dist.apache.org/repos/dist/dev/beam
cd beam/${RELEASE}
svn add *
svn commit
</code></pre>
</div>

<p>Verify that files are <a href="https://dist.apache.org/repos/dist/dev/beam">present</a>.</p>

<h4 id="build-the-pydoc-api-reference">Build the Pydoc API reference</h4>

<p>Make sure you have <code class="highlighter-rouge">tox</code> installed:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>pip install tox
</code></pre>
</div>
<p>Create the Python SDK documentation using sphinx by running a helper script.</p>
<div class="highlighter-rouge"><pre class="highlight"><code>cd sdks/python &amp;&amp; tox -e docs
</code></pre>
</div>
<p>By default the Pydoc is generated in <code class="highlighter-rouge">sdks/python/target/docs/_build</code>. Let <code class="highlighter-rouge">${PYDOC_ROOT}</code> be the absolute path to <code class="highlighter-rouge">_build</code>.</p>

<h4 id="propose-pull-requests-for-website-updates">Propose pull requests for website updates</h4>

<p>Beam publishes API reference manuals for each release on the website. For Java
and Python SDKs, that’s Javadoc and PyDoc, respectively. The final step of
building the candidate is to propose website pull requests that update these
manuals.</p>

<p>Merge the pull requests only after finalizing the release. To avoid invalid
redirects for the ‘current’ version, merge these PRs in the order listed. Once
the PR is merged, the new contents will get picked up automatically and served
to the Beam website, usually within an hour.</p>

<p><strong>PR 1: apache/beam-site</strong></p>

<p>This pull request is against the <code class="highlighter-rouge">apache/beam-site</code> repo, on the <code class="highlighter-rouge">release-docs</code>
branch.</p>

<ul>
  <li>Add the new Javadoc to <a href="https://beam.apache.org/releases/javadoc/">SDK API Reference page</a> page, as follows:
    <ul>
      <li>Unpack the Maven artifact <code class="highlighter-rouge">org.apache.beam:beam-sdks-java-javadoc</code> into some temporary location. Call this <code class="highlighter-rouge">${JAVADOC_TMP}</code>.</li>
      <li>Copy the generated Javadoc into the website repository: <code class="highlighter-rouge">cp -r ${JAVADOC_TMP} javadoc/${RELEASE}</code>.</li>
    </ul>
  </li>
  <li>Add the new Pydoc to <a href="https://beam.apache.org/releases/pydoc/">SDK API Reference page</a> page, as follows:
    <ul>
      <li>Copy the generated Pydoc into the website repository: <code class="highlighter-rouge">cp -r ${PYDOC_ROOT} pydoc/${RELEASE}</code>.</li>
      <li>Remove <code class="highlighter-rouge">.doctrees</code> directory.</li>
    </ul>
  </li>
  <li>Stage files using: <code class="highlighter-rouge">git add --all javadoc/ pydoc/</code>.</li>
</ul>

<p><strong>PR 2: apache/beam</strong></p>

<p>This pull request is against the <code class="highlighter-rouge">apache/beam</code> repo, on the <code class="highlighter-rouge">master</code> branch.</p>

<ul>
  <li>Update the <code class="highlighter-rouge">release_latest</code> version flag in <code class="highlighter-rouge">/website/_config.yml</code>, and list
the new release in <code class="highlighter-rouge">/website/src/get-started/downloads.md</code>, linking to the
source code download and the Release Notes in JIRA.</li>
  <li>Update the <code class="highlighter-rouge">RedirectMatch</code> rule in
<a href="https://github.com/apache/beam/blob/master/website/src/.htaccess">/website/src/.htaccess</a>
to point to the new release. See file history for examples.</li>
</ul>

<h4 id="build-and-stage-python-wheels">Build and stage python wheels</h4>

<p>There is a wrapper repo <a href="https://github.com/apache/beam-wheels">beam-wheels</a> to help build python wheels.</p>

<p>If you are interested in how it works, please refer to the <a href="https://github.com/apache/beam-wheels#structure">structure section</a>.</p>

<p>Please follow the <a href="https://github.com/apache/beam-wheels#user-guide">user guide</a> to build python wheels.</p>

<p>Once all python wheels have been staged <a href="https://dist.apache.org/repos/dist/dev/beam/">dist.apache.org</a>, 
please run <a href="https://github.com/apache/beam/blob/master/release/src/main/scripts/sign_hash_python_wheels.sh">./sign_hash_python_wheels.sh</a> to sign and hash python wheels.</p>

<h3 id="write-the-beam-blog-post-and-create-a-pull-request">Write the Beam blog post and create a pull request</h3>

<p>Major or otherwise important releases should have a blog post. Write one if needed for this particular release. Minor releases that don’t introduce new major functionality don’t necessarily need to be blogged.</p>

<p><em>Tip:</em> Use git log to find contributors to the releases. (e.g: <code class="highlighter-rouge">git log --pretty='%aN' ^v2.10.0 v2.11.0 | sort | uniq</code>).</p>

<h4 id="checklist-to-proceed-to-the-next-step-2">Checklist to proceed to the next step</h4>

<ol>
  <li>Maven artifacts deployed to the staging repository of <a href="https://repository.apache.org/content/repositories/">repository.apache.org</a></li>
  <li>Source distribution deployed to the dev repository of <a href="https://dist.apache.org/repos/dist/dev/beam/">dist.apache.org</a></li>
  <li>Website pull request proposed to list the <a href="/get-started/downloads/">release</a>, publish the <a href="https://beam.apache.org/releases/javadoc/">Java API reference manual</a>, and publish the <a href="https://beam.apache.org/releases/pydoc/">Python API reference manual</a>.</li>
</ol>

<p>You can (optionally) also do additional verification by:</p>
<ol>
  <li>Check that Python zip file contains the <code class="highlighter-rouge">README.md</code>, <code class="highlighter-rouge">NOTICE</code>, and <code class="highlighter-rouge">LICENSE</code> files.</li>
  <li>Check hashes (e.g. <code class="highlighter-rouge">md5sum -c *.md5</code> and <code class="highlighter-rouge">sha1sum -c *.sha1</code>)</li>
  <li>Check signatures (e.g. <code class="highlighter-rouge">gpg --verify apache-beam-1.2.3-python.zip.asc apache-beam-1.2.3-python.zip</code>)</li>
  <li><code class="highlighter-rouge">grep</code> for legal headers in each file.</li>
  <li>Run all jenkins suites and include links to passing tests in the voting email. (Select “Run with parameters”)</li>
</ol>

<hr />

<h2 id="vote-on-the-release-candidate">Vote on the release candidate</h2>

<p>Once you have built and individually reviewed the release candidate, please share it for the community-wide review. Please review foundation-wide <a href="http://www.apache.org/foundation/voting.html">voting guidelines</a> for more information.</p>

<p>Start the review-and-vote thread on the dev@ mailing list. Here’s an email template; please adjust as you see fit.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>From: Release Manager
To: dev@beam.apache.org
Subject: [VOTE] Release 1.2.3, release candidate #3

Hi everyone,
Please review and vote on the release candidate #3 for the version 1.2.3, as follows:
[ ] +1, Approve the release
[ ] -1, Do not approve the release (please provide specific comments)


The complete staging area is available for your review, which includes:
* JIRA release notes [1],
* the official Apache source release to be deployed to dist.apache.org [2], which is signed with the key with fingerprint FFFFFFFF [3],
* all artifacts to be deployed to the Maven Central Repository [4],
* source code tag "v1.2.3-RC3" [5],
* website pull request listing the release [6], publishing the API reference manual [7], and the blog post [8].
* Java artifacts were built with Maven MAVEN_VERSION and OpenJDK/Oracle JDK JDK_VERSION.
* Python artifacts are deployed along with the source release to the dist.apache.org [2].
* Validation sheet with a tab for 1.2.3 release to help with validation [9].

The vote will be open for at least 72 hours. It is adopted by majority approval, with at least 3 PMC affirmative votes.

Thanks,
Release Manager

[1] https://jira.apache.org/jira/secure/ReleaseNote.jspa?projectId=...
[2] https://dist.apache.org/repos/dist/dev/beam/1.2.3/
[3] https://dist.apache.org/repos/dist/release/beam/KEYS
[4] https://repository.apache.org/content/repositories/orgapachebeam-NNNN/
[5] https://github.com/apache/beam/tree/v1.2.3-RC3
[6] https://github.com/apache/beam/pull/...
[7] https://github.com/apache/beam-site/pull/...
[8] https://github.com/apache/beam/pull/...
[9] https://docs.google.com/spreadsheets/d/1qk-N5vjXvbcEk68GjbkSZTR8AGqyNUM-oLFo_ZXBpJw/edit#gid=...
</code></pre>
</div>

<p>If there are any issues found in the release candidate, reply on the vote thread to cancel the vote. There’s no need to wait 72 hours. Proceed to the <code class="highlighter-rouge">Fix Issues</code> step below and address the problem. However, some issues don’t require cancellation. For example, if an issue is found in the website pull request, just correct it on the spot and the vote can continue as-is.</p>

<p>If there are no issues, reply on the vote thread to close the voting. Then, tally the votes in a separate email. Here’s an email template; please adjust as you see fit.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>From: Release Manager
To: dev@beam.apache.org
Subject: [RESULT] [VOTE] Release 1.2.3, release candidate #3

I'm happy to announce that we have unanimously approved this release.

There are XXX approving votes, XXX of which are binding:
* approver 1
* approver 2
* approver 3
* approver 4

There are no disapproving votes.

Thanks everyone!
</code></pre>
</div>

<h3 id="run-validation-tests">Run validation tests</h3>
<p>All tests listed in this <a href="https://s.apache.org/beam-release-validation">spreadsheet</a></p>

<p>Since there are a bunch of tests, we recommend you running validations using automation script. In case of script failure, you can still run all of them manually.</p>

<h4 id="run-validations-using-run_rc_validationsh">Run validations using run_rc_validation.sh</h4>
<ul>
  <li>
    <p>Script: <a href="https://github.com/apache/beam/blob/master/release/src/main/scripts/run_rc_validation.sh">run_rc_validation.sh</a></p>
  </li>
  <li>
    <p>Usage</p>

    <div class="highlighter-rouge"><pre class="highlight"><code>./beam/release/src/main/scripts/run_rc_validation.sh
</code></pre>
    </div>
  </li>
  <li>Tasks included
    <ol>
      <li>Run Java quickstart with Direct Runner, Apex local runner, Flink local runner, Spark local runner and Dataflow runner.</li>
      <li>Run Java Mobile Games(UserScore, HourlyTeamScore, Leaderboard) with Dataflow runner.</li>
      <li>Create a PR against apache:master to trigger python validation job, including
        <ul>
          <li>Python quickstart in batch and streaming mode with direct runner and Dataflow runner.</li>
          <li>Python Mobile Games(UserScore, HourlyTeamScore) with direct runner and Dataflow runner.</li>
        </ul>
      </li>
      <li>Run Python Streaming MobileGames, includes
        <ul>
          <li>Start a new terminal to run Java Pubsub injector.</li>
          <li>Start a new terminal to run python LeaderBoard with Direct Runner.</li>
          <li>Start a new terminal to run python LeaderBoard with Dataflow Runner.</li>
          <li>Start a new terminal to run python GameStats with Direct Runner.</li>
          <li>Start a new terminal to run python GameStats with Dataflow Runner.</li>
        </ul>
      </li>
    </ol>
  </li>
  <li>Tasks you need to do manually
    <ol>
      <li>Check whether validations succeed by following console output instructions.</li>
      <li>Terminate streaming jobs and java injector.</li>
      <li>Sign up <a href="https://s.apache.org/beam-release-validation">spreadsheet</a>.</li>
      <li>Vote in the release thread.</li>
    </ol>
  </li>
</ul>

<h4 id="run-validations-manually">Run validations manually</h4>

<p><em>Note</em>: -Prepourl and -Pver can be found in the RC vote email sent by Release Manager.</p>

<ul>
  <li>
    <p>Java Quickstart Validation</p>

    <p>Direct Runner:</p>
    <div class="highlighter-rouge"><pre class="highlight"><code>./gradlew :runners:direct-java:runQuickstartJavaDirect \
-Prepourl=https://repository.apache.org/content/repositories/orgapachebeam-${KEY} \
-Pver=${RELEASE_VERSION}
</code></pre>
    </div>
    <p>Apex Local Runner</p>
    <div class="highlighter-rouge"><pre class="highlight"><code>./gradlew :runners:apex:runQuickstartJavaApex \
-Prepourl=https://repository.apache.org/content/repositories/orgapachebeam${KEY} \
-Pver=${RELEASE_VERSION}
</code></pre>
    </div>
    <p>Flink Local Runner</p>
    <div class="highlighter-rouge"><pre class="highlight"><code>./gradlew :runners:flink:1.5:runQuickstartJavaFlinkLocal \
-Prepourl=https://repository.apache.org/content/repositories/orgapachebeam-${KEY} \
-Pver=${RELEASE_VERSION}
</code></pre>
    </div>
    <p>Spark Local Runner</p>
    <div class="highlighter-rouge"><pre class="highlight"><code>./gradlew :runners:spark:runQuickstartJavaSpark \
-Prepourl=https://repository.apache.org/content/repositories/orgapachebeam-${KEY} \
-Pver=${RELEASE_VERSION}
</code></pre>
    </div>
    <p>Dataflow Runner</p>
    <div class="highlighter-rouge"><pre class="highlight"><code>./gradlew :runners:google-cloud-dataflow-java:runQuickstartJavaDataflow \
-Prepourl=https://repository.apache.org/content/repositories/orgapachebeam-${KEY} \
-Pver=${RELEASE_VERSION} \
-PgcpProject=${YOUR_GCP_PROJECT} \
-PgcsBucket=${YOUR_GCP_BUCKET}
</code></pre>
    </div>
  </li>
  <li>
    <p>Java Mobile Game(UserScore, HourlyTeamScore, Leaderboard)</p>

    <p>Pre-request</p>
    <ul>
      <li>Create your own BigQuery dataset
        <div class="highlighter-rouge"><pre class="highlight"><code>bq mk --project=${YOUR_GCP_PROJECT} ${YOUR_DATASET}
</code></pre>
        </div>
      </li>
      <li>Create yout PubSub topic
        <div class="highlighter-rouge"><pre class="highlight"><code>gcloud alpha pubsub topics create --project=${YOUR_GCP_PROJECT} ${YOUR_PROJECT_PUBSUB_TOPIC} 
</code></pre>
        </div>
      </li>
      <li>
        <p>Setup your service account</p>

        <p>Goto IAM console in your project to create a service account as <code class="highlighter-rouge">project owner</code></p>

        <p>Run</p>
        <div class="highlighter-rouge"><pre class="highlight"><code>gcloud iam service-accounts keys create ${YOUR_KEY_JSON} --iam-account ${YOUR_SERVICE_ACCOUNT_NAME}@${YOUR_PROJECT_NAME}
export GOOGLE_APPLICATION_CREDENTIALS=${PATH_TO_YOUR_KEY_JSON} 
</code></pre>
        </div>
        <p>Run</p>
        <div class="highlighter-rouge"><pre class="highlight"><code>./gradlew :runners:google-cloud-dataflow-java:runMobileGamingJavaDataflow \
 -Prepourl=https://repository.apache.org/content/repositories/orgapachebeam-${KEY} \ 
 -Pver=${RELEASE_VERSION} \
 -PgcpProject=${YOUR_GCP_PROJECT} \
 -PgcsBucket=${YOUR_GCP_BUCKET} \
 -PbqDataset=${YOUR_DATASET} -PpubsubTopic=${YOUR_PROJECT_PUBSUB_TOPIC}
</code></pre>
        </div>
      </li>
    </ul>
  </li>
  <li>
    <p>Python Quickstart(batch &amp; streaming), MobileGame(UserScore, HourlyTeamScore)</p>

    <p>Create a new PR in apache/beam</p>

    <p>In comment area, type in <code class="highlighter-rouge">Run Python ReleaseCandidate</code></p>
  </li>
  <li>
    <p>Python Leaderboard &amp; GameStats</p>
    <ul>
      <li>Get staging RC <code class="highlighter-rouge">wget https://dist.apache.org/repos/dist/dev/beam/2.5.0/*</code></li>
      <li>
        <p>Verify the hashes</p>

        <div class="highlighter-rouge"><pre class="highlight"><code>sha512sum -c apache-beam-2.5.0-python.zip.sha512
sha512sum -c apache-beam-2.5.0-source-release.zip.sha512
</code></pre>
        </div>
      </li>
      <li>
        <p>Build SDK</p>

        <div class="highlighter-rouge"><pre class="highlight"><code>sudo apt-get install unzip
unzip apache-beam-2.5.0-source-release.zip
python setup.py sdist
</code></pre>
        </div>
      </li>
      <li>
        <p>Setup virtualenv</p>

        <div class="highlighter-rouge"><pre class="highlight"><code>pip install --upgrade pip
pip install --upgrade setuptools
pip install --upgrade virtualenv
virtualenv beam_env
 . beam_env/bin/activate
</code></pre>
        </div>
      </li>
      <li>
        <p>Install SDK</p>

        <div class="highlighter-rouge"><pre class="highlight"><code>pip install dist/apache-beam-2.5.0.tar.gz
pip install dist/apache-beam-2.5.0.tar.gz[gcp]
</code></pre>
        </div>
      </li>
      <li>
        <p>Setup GCP</p>

        <p>Please repeat following steps for every following test.</p>

        <div class="highlighter-rouge"><pre class="highlight"><code>bq rm -rf --project=${YOUR_PROJECT} ${USER}_test
bq mk --project=${YOUR_PROJECT} ${USER}_test
gsutil rm -rf ${YOUR_GS_STORAGE]
gsutil mb -p ${YOUR_PROJECT} ${YOUR_GS_STORAGE}
gcloud alpha pubsub topics create --project=${YOUR_PROJECT} ${YOUR_PUBSUB_TOPIC}
</code></pre>
        </div>
        <p>Setup your service account as described in <code class="highlighter-rouge">Java Mobile Game</code> section above.</p>

        <p>Produce data by using java injector:</p>
        <ul>
          <li>Configure your ~/.m2/settings.xml as following:
            <div class="highlighter-rouge"><pre class="highlight"><code>&lt;settings&gt;
  &lt;profiles&gt;
    &lt;profile&gt;
      &lt;id&gt;release-repo&lt;/id&gt;
      &lt;activation&gt;
        &lt;activeByDefault&gt;true&lt;/activeByDefault&gt;
      &lt;/activation&gt;
      &lt;repositories&gt;
        &lt;repository&gt;
          &lt;id&gt;Release 2.4.0 RC3&lt;/id&gt;
          &lt;name&gt;Release 2.4.0 RC3&lt;/name&gt;
          &lt;url&gt;https://repository.apache.org/content/repositories/orgapachebeam-1031/&lt;/url&gt;
        &lt;/repository&gt;
      &lt;/repositories&gt;
    &lt;/profile&gt;
  &lt;/profiles&gt;
&lt;/settings&gt;
</code></pre>
            </div>
            <p><em>Note</em>: You can found the latest  <code class="highlighter-rouge">id</code>, <code class="highlighter-rouge">name</code> and <code class="highlighter-rouge">url</code> for one RC in the vote email thread sent out by Release Manager.</p>
          </li>
          <li>Run
            <div class="highlighter-rouge"><pre class="highlight"><code>mvn archetype:generate \
      -DarchetypeGroupId=org.apache.beam \
      -DarchetypeArtifactId=beam-sdks-java-maven-archetypes-examples \
      -DarchetypeVersion=${RELEASE_VERSION} \
      -DgroupId=org.example \
      -DartifactId=word-count-beam \
      -Dversion="0.1" \
      -Dpackage=org.apache.beam.examples \
      -DinteractiveMode=false
      -DarchetypeCatalog=internal
            
mvn compile exec:java -Dexec.mainClass=org.apache.beam.examples.complete.game.injector.Injector \
  -Dexec.args="${YOUR_PROJECT} ${YOUR_PUBSUB_TOPIC} none"
</code></pre>
            </div>
          </li>
        </ul>
      </li>
      <li>Run Leaderboard with Direct Runner
        <div class="highlighter-rouge"><pre class="highlight"><code>python -m apache_beam.examples.complete.game.leader_board \
--project=${YOUR_PROJECT} \
--topic projects/${YOUR_PROJECT}/topics/${YOUR_PUBSUB_TOPIC} \
--dataset ${USER}_test
</code></pre>
        </div>
        <p>Inspect results:</p>
        <ul>
          <li>Check whether there is any error messages in console.</li>
          <li>Goto your BigQuery console and check whether your ${USER}_test has leader_board_users and leader_board_teams table.</li>
          <li>bq head -n 10 ${USER}_test.leader_board_users</li>
          <li>bq head -n 10 ${USER}_test.leader_board_teams</li>
        </ul>
      </li>
      <li>Run Leaderboard with Dataflow Runner
        <div class="highlighter-rouge"><pre class="highlight"><code>python -m apache_beam.examples.complete.game.leader_board \ 
--project=${YOUR_PROJECT} \ 
--topic projects/${YOUR_PROJECT}/topics/${YOUR_PUBSUB_TOPIC} \ 
--dataset ${USER}_test \ 
--runner DataflowRunner \ 
--temp_location=${YOUR_GS_BUCKET}/temp/ \ 
--sdk_location dist/*
</code></pre>
        </div>
        <p>Inspect results:</p>
        <ul>
          <li>Goto your Dataflow job console and check whether there is any error.</li>
          <li>Goto your BigQuery console and check whether your ${USER}_test has leader_board_users and leader_board_teams table.</li>
          <li>bq head -n 10 ${USER}_test.leader_board_users</li>
          <li>bq head -n 10 ${USER}_test.leader_board_teams</li>
        </ul>
      </li>
      <li>Run GameStats with Direct Runner
        <div class="highlighter-rouge"><pre class="highlight"><code>python -m apache_beam.examples.complete.game.game_stats \
--project=${YOUR_PROJECT} \
--topic projects/${YOUR_PROJECT}/topics/${YOUR_PUBSUB_TOPIC} \
--dataset ${USER}_test \
--fixed_window_duration ${SOME_SMALL_DURATION}
</code></pre>
        </div>
        <p>Inspect results:</p>
        <ul>
          <li>Check whether there is any error messages in console.</li>
          <li>Goto your BigQuery console and check whether your ${USER}_test has game_stats_teams and game_stats_sessions table.</li>
          <li>bq head -n 10 ${USER}_test.game_stats_teams</li>
          <li>bq head -n 10 ${USER}_test.game_stats_sessions</li>
        </ul>
      </li>
      <li>Run GameStats with Dataflow Runner
        <div class="highlighter-rouge"><pre class="highlight"><code>python -m apache_beam.examples.complete.game.game_stats \ 
--project=${YOUR_PROJECT} \ 
--topic projects/${YOUR_PROJECT}/topics/${YOUR_PUBSUB_TOPIC} \ 
--dataset ${USER}_test \ 
--runner DataflowRunner \ 
--temp_location=${YOUR_GS_BUCKET}/temp/ \ 
--sdk_location dist/* \
--fixed_window_duration ${SOME_SMALL_DURATION}
</code></pre>
        </div>
        <p>Inspect results:</p>
        <ul>
          <li>Goto your Dataflow job console and check whether there is any error.</li>
          <li>Goto your BigQuery console and check whether your ${USER}_test has game_stats_teams and game_stats_sessions table.</li>
          <li>bq head -n 10 ${USER}_test.game_stats_teams</li>
          <li>bq head -n 10 ${USER}_test.game_stats_sessions</li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<h3 id="checklist-to-proceed-to-the-finalization-step">Checklist to proceed to the finalization step</h3>

<ol>
  <li>Community votes to release the proposed candidate, with at least three approving PMC votes</li>
</ol>

<hr />

<h2 id="fix-any-issues">Fix any issues</h2>

<p>Any issues identified during the community review and vote should be fixed in this step. Additionally, any JIRA issues created from the initial branch verification should be fixed.</p>

<p>Code changes should be proposed as standard pull requests to the <code class="highlighter-rouge">master</code> branch and reviewed using the normal contributing process. Then, relevant changes should be cherry-picked into the release branch. The cherry-pick commits should then be proposed as the pull requests against the release branch, again reviewed and merged using the normal contributing process.</p>

<p>Once all issues have been resolved, you should go back and build a new release candidate with these changes.</p>

<h3 id="checklist-to-proceed-to-the-next-step-3">Checklist to proceed to the next step</h3>

<ol>
  <li>Issues identified during vote have been resolved, with fixes committed to the release branch.</li>
  <li>All issues tagged with <code class="highlighter-rouge">Fix-Version</code> for the current release should be closed.</li>
</ol>

<hr />

<h2 id="finalize-the-release">Finalize the release</h2>

<p>Once the release candidate has been reviewed and approved by the community, the release should be finalized. This involves the final deployment of the release candidate to the release repositories, merging of the website changes, etc.</p>

<h3 id="deploy-artifacts-to-maven-central-repository">Deploy artifacts to Maven Central Repository</h3>

<p>Use the Apache Nexus repository to release the staged binary artifacts to the Maven Central repository. In the <code class="highlighter-rouge">Staging Repositories</code> section, find the relevant release candidate <code class="highlighter-rouge">orgapachebeam-XXX</code> entry and click <code class="highlighter-rouge">Release</code>. Drop all other release candidates that are not being released.</p>

<h3 id="deploy-python-artifacts-to-pypi">Deploy Python artifacts to PyPI</h3>

<ol>
  <li>Create a new release and upload the Python zip file for the new release using the [PyPI UI] (https://pypi.python.org/pypi/apache-beam)</li>
  <li>Alternatively, use the command line tool to upload the new release <code class="highlighter-rouge">twine upload apache-beam-${RELEASE}.zip</code></li>
</ol>

<p>Note: It is important to rename <code class="highlighter-rouge">apache-beam-${RELEASE}-python.zip</code> to <code class="highlighter-rouge">apache-beam-${RELEASE}.zip</code> before uploading, because PyPI expects a filename in the <code class="highlighter-rouge">&lt;package-name&gt;-&lt;package-version&gt;</code> format.</p>

<h4 id="deploy-source-release-to-distapacheorg">Deploy source release to dist.apache.org</h4>

<p>Copy the source release from the <code class="highlighter-rouge">dev</code> repository to the <code class="highlighter-rouge">release</code> repository at <code class="highlighter-rouge">dist.apache.org</code> using Subversion.</p>

<p>Move last release artifacts from <code class="highlighter-rouge">dist.apache.org</code> to <code class="highlighter-rouge">archive.apache.org</code> using Subversion. Then update download address for last release version, <a href="https://github.com/apache/beam-site/pull/478">example PR</a>.</p>

<h3 id="git-tag">Git tag</h3>

<p>Create and push a new signed tag for the released version by copying the tag for the final release candidate, as follows:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>VERSION_TAG="v${RELEASE}"
git tag -s "$VERSION_TAG" "$RC_TAG"
git push github "$VERSION_TAG"
</code></pre>
</div>

<h3 id="merge-website-pull-request">Merge website pull request</h3>

<p>Merge the website pull request to <a href="/get-started/downloads/">list the release</a>, publish the <a href="https://beam.apache.org/releases/pydoc/">Python API reference manual</a>, and the <a href="https://beam.apache.org/releases/javadoc/">Java API reference manual</a> created earlier.</p>

<h3 id="mark-the-version-as-released-in-jira">Mark the version as released in JIRA</h3>

<p>In JIRA, inside <a href="https://issues.apache.org/jira/plugins/servlet/project-config/BEAM/versions">version management</a>, hover over the current release and a settings menu will appear. Click <code class="highlighter-rouge">Release</code>, and select today’s date.</p>

<h3 id="recordkeeping-with-asf">Recordkeeping with ASF</h3>

<p>Use reporter.apache.org to seed the information about the release into future project reports.</p>

<h3 id="checklist-to-proceed-to-the-next-step-4">Checklist to proceed to the next step</h3>

<ul>
  <li>Maven artifacts released and indexed in the <a href="https://search.maven.org/#search%7Cga%7C1%7Cg%3A%22org.apache.beam%22">Maven Central Repository</a></li>
  <li>Source distribution available in the release repository of <a href="https://dist.apache.org/repos/dist/release/beam/">dist.apache.org</a></li>
  <li>Source distribution removed from the dev repository of <a href="https://dist.apache.org/repos/dist/dev/beam/">dist.apache.org</a></li>
  <li>Website pull request to <a href="/get-started/downloads/">list the release</a> and publish the <a href="https://beam.apache.org/releases/javadoc/">API reference manual</a> merged</li>
  <li>Release tagged in the source code repository</li>
  <li>Release version finalized in JIRA. (Note: Not all committers have administrator access to JIRA. If you end up getting permissions errors ask on the mailing list for assistance.)</li>
  <li>Release version is listed at reporter.apache.org</li>
</ul>

<hr />

<h2 id="promote-the-release">Promote the release</h2>

<p>Once the release has been finalized, the last step of the process is to promote the release within the project and beyond.</p>

<h3 id="apache-mailing-lists">Apache mailing lists</h3>

<p>Announce on the dev@ mailing list that the release has been finished.</p>

<p>Announce on the release on the user@ mailing list, listing major improvements and contributions.</p>

<p>Announce the release on the announce@apache.org mailing list.</p>

<h3 id="social-media">Social media</h3>

<p>Tweet, post on Facebook, LinkedIn, and other platforms. Ask other contributors to do the same.</p>

<p>Also, update <a href="https://en.wikipedia.org/wiki/Apache_Beam">the Wikipedia article on Apache Beam</a>.</p>

<h3 id="checklist-to-declare-the-process-completed">Checklist to declare the process completed</h3>

<ol>
  <li>Release announced on the user@ mailing list.</li>
  <li>Blog post published, if applicable.</li>
  <li>Release recorded in reporter.apache.org.</li>
  <li>Release announced on social media.</li>
  <li>Completion declared on the dev@ mailing list.</li>
  <li>Update Wikipedia Apache Beam article.</li>
</ol>

<hr />

<h2 id="improve-the-process">Improve the process</h2>

<p>It is important that we improve the release processes over time. Once you’ve finished the release, please take a step back and look what areas of this process and be improved. Perhaps some part of the process can be simplified. Perhaps parts of this guide can be clarified.</p>

<p>If we have specific ideas, please start a discussion on the dev@ mailing list and/or propose a pull request to update this guide. Thanks!</p>

      </div>
    </div>
    <!--
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at
   http://www.apache.org/licenses/LICENSE-2.0
 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License. See accompanying LICENSE file.
-->

<footer class="footer">
  <div class="footer__contained">
    <div class="footer__cols">
      <div class="footer__cols__col">
        <div class="footer__cols__col__logo">
          <img src="/images/beam_logo_circle.svg" class="footer__logo" alt="Beam logo">
        </div>
        <div class="footer__cols__col__logo">
          <img src="/images/apache_logo_circle.svg" class="footer__logo" alt="Apache logo">
        </div>
      </div>
      <div class="footer__cols__col footer__cols__col--md">
        <div class="footer__cols__col__title">Start</div>
        <div class="footer__cols__col__link"><a href="/get-started/beam-overview/">Overview</a></div>
        <div class="footer__cols__col__link"><a href="/get-started/quickstart-java/">Quickstart (Java)</a></div>
        <div class="footer__cols__col__link"><a href="/get-started/quickstart-py/">Quickstart (Python)</a></div>
        <div class="footer__cols__col__link"><a href="/get-started/quickstart-go/">Quickstart (Go)</a></div>
        <div class="footer__cols__col__link"><a href="/get-started/downloads/">Downloads</a></div>
      </div>
      <div class="footer__cols__col footer__cols__col--md">
        <div class="footer__cols__col__title">Docs</div>
        <div class="footer__cols__col__link"><a href="/documentation/programming-guide/">Concepts</a></div>
        <div class="footer__cols__col__link"><a href="/documentation/pipelines/design-your-pipeline/">Pipelines</a></div>
        <div class="footer__cols__col__link"><a href="/documentation/runners/capability-matrix/">Runners</a></div>
      </div>
      <div class="footer__cols__col footer__cols__col--md">
        <div class="footer__cols__col__title">Community</div>
        <div class="footer__cols__col__link"><a href="/contribute/">Contribute</a></div>
        <div class="footer__cols__col__link"><a href="https://projects.apache.org/committee.html?beam" target="_blank">Team<img src="/images/external-link-icon.png"
                                                                                                                                width="14" height="14"
                                                                                                                                alt="External link."></a></div>
        <div class="footer__cols__col__link"><a href="/contribute/presentation-materials/">Media</a></div>
      </div>
      <div class="footer__cols__col footer__cols__col--md">
        <div class="footer__cols__col__title">Resources</div>
        <div class="footer__cols__col__link"><a href="/blog/">Blog</a></div>
        <div class="footer__cols__col__link"><a href="/get-started/support/">Support</a></div>
        <div class="footer__cols__col__link"><a href="https://github.com/apache/beam">GitHub</a></div>
      </div>
    </div>
  </div>
  <div class="footer__bottom">
    &copy;
    <a href="http://www.apache.org">The Apache Software Foundation</a>
    | <a href="/privacy_policy">Privacy Policy</a>
    | <a href="/feed.xml">RSS Feed</a>
    <br><br>
    Apache Beam, Apache, Beam, the Beam logo, and the Apache feather logo are
    either registered trademarks or trademarks of The Apache Software
    Foundation. All other products or name brands are trademarks of their
    respective holders, including The Apache Software Foundation.
  </div>
</footer>

  </body>
</html>
